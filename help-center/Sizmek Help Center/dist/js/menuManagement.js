$(document).ready(function(){var t='<li class="addNew"><a class="addNewButton">+ ADD</a></li>';if(menuObj={},menuCopy="",currentItems=[],$mainWrapper=$("#main-wrap"),dropdownValue="",editChildren=[],lastModifiedParent="",articles=[],sections=[],sectionsFirstIndex=0,sectionsLastIndex=0,articlesChangeLOC=[],articleUpdate=!1,oldIndex=0,newIndex=0,sectionsToHide=[],sectionsToShow=[],articlesToHide=[],articlesToShow=[],-1!==jQuery.inArray("view_support_content",HelpCenter.user.tags)&&$("#user-menu").append("<a id='menuAdmin' role='menuitem' href='/hc/en-us/articles/"+menuManagementPage+"'>Menu Management</a>"),-1<window.location.href.indexOf(menuManagementPage)){function e(e){e.parent().append('<select class="type" style="background-color: #ffffff;"><option value="text">Text</option><option value="category">Category</option><option value=section>Section</option><option value="custom">Custom</option></select><select class="visibility" style="background-color: #ffffff;"><option value="1">Visible to everyone</option><option value="2">Agents and Manager</option><option value="3">Signed-in users</option><option value="4">User Segment:</option></select><a class="saveButton" style="display:inline;" title="Save"><i class="fa fa-check" style="font-size: 20px;"></i></a><a class="cancelButton" title="Cancel"><i class="fa fa-times" style="font-size: 20px;"></i></a>')}function l(e){var t=e;t.children(".select2").remove(),t.children("select.type").toggleClass("currentSelect"),t.children("input, #sectionDropdown, #categoryDropdown").remove(),t.children(".item-name, .fa").css("display","block"),t.children("select.type").val(dropdownValue),t.children("select").css("background-color","#e0e0e0").attr("disabled","disabled"),t.children(".editSaveButton, .editCancelButton").css("display","none"),t.children(".editButton, .deleteButton").css("display","inline")}function a(e){var t=e;t.children(".select2, p").remove(),t.children('input[type="checkbox"]').toggle(),t.children("select.type").toggleClass("currentSelect"),t.children("input:not(.open-tab), #sectionDropdown, #categoryDropdown").remove(),t.children(".item-name, .fa").css("display","block"),t.children("select.type").val(dropdownValue),t.children("select").attr("disabled","disabled").css("background-color","#e0e0e0"),t.children("label,.edit-save-child, .cancel-edit-child").css("display","none"),t.children(".edit-child-button, .delete-child-button").css("display","inline")}$("form").remove(),$(".incident-wrapper").remove(),$mainWrapper=$("#main-wrap"),$mainWrapper.append('<button id="save-changes" type="button" class="btn btn-primary" disabled>Save</button>'),i(),$("body").on("change","#products",function(){m(),o()}),$("body").on("click",".menuManagement .fa.fa-angle-right, .menuManagement .fa.fa-angle-down",function(){var r,n,a,e,t=$(this).parent(),i=t.children("ul");if(t.css("background-color","white"),i.children().length)i.is(":visible")?(i.slideUp().css("display","none"),s(!0)):(i.slideDown().css("display","block"),s(!1));else if("category"===t.children(".type").val())r=t,a=!(n=""),e=parseInt(r.children("select.type").attr("id")),r.children("i.fa-angle-down, i.fa-angle-right, .categoryDrop").css({cursor:"wait"}),$.get("/api/v2/help_center/en-us/categories/"+e+"/sections").done(function(e){sections=e.sections,sections.forEach(function(e){n+='<li id="'+e.id+'"><i class="fas fa-grip-vertical"></i><i class="fa fa-angle-right" style="font-size: 16px;"></i><div class="item-name"><a class="categoryDrop link-zendesk" href="/hc/admin/sections/'+e.id+'/edit" target="_blank">'+e.name+'</a></div><select class="type" id="select-'+e.id+'"><option value="section">Section</option><option value="text">Text</option><option value="category">Category</option><option value="custom">Custom</option></select></li>'}),r.children("ul").append(n);for(var t=0;t<sections.length;t++)!function(s){var l="fa-eye-slash",c=!0,o="Show To All Shared Platform";$.get("/api/v2/help_center/en-us/sections/"+sections[s].id+"/articles").done(function(e){var t,i="mdx2"==(t=$("#products").val())?t:"sas"==t?"mdxnxt":"newDsp"==t?"newdsp":"dsp"==t?t:"dmp"==t?t:t=t,n=!0;sections[s].description&&sections[s].description.includes("hidden")&&(n=!1),0<e.count&&n&&e.articles.forEach(function(e){var t=e.label_names,n=t.includes(i);"supportKb"!=i&&t.length||(n=!0),t.includes("mdx2")||t.includes("mdx_nxt")||t.includes("mdxnxt")||t.includes("newdsp")||t.includes("dsp")||t.includes("dmp")||(n=!0),!n||e.draft||t.includes("hidden")||(c=!(l="fa-eye"),o="Hide To All Shared Platform")}),r.find("#"+sections[s].id).append('<a class="section-visibility"><i class="fa '+l+'" style="font-size: 20px;" title="'+o+'"></i></a>'),c&&r.find("#"+sections[s].id).children(".item-name").children(".categoryDrop").addClass("lineTrough");var a=b(e.articles);(!e.count||a)&&r.find("#"+sections[s].id).find(".section-visibility").css({"pointer-events":"none"}),s===sections.length-1&&r.children("i.fa-angle-down, i.fa-angle-right, .categoryDrop").css({cursor:"pointer"})})}(t);r.children("ul").nestedSortable({disableParentChange:!0,protectRoot:!0,items:"> li",placeholder:"ui-state-highlight",listType:"ul",handle:".fa-grip-vertical",relocate:function(e,t){var n=$("#mainUL #"+t.item[0].id).index(),i=sections.findIndex(function(e){return e.id==t.item[0].id});a&&(sectionsFirstIndex=oldIndex,sectionsLastIndex=i,a=!1),sectionsFirstIndex>sectionsLastIndex&&(sectionsFirstIndex+=sectionsLastIndex,sectionsLastIndex=sectionsFirstIndex-sectionsLastIndex,sectionsFirstIndex-=sectionsLastIndex),i<n?(i<sectionsFirstIndex&&(sectionsFirstIndex=i),n>sectionsLastIndex&&(sectionsLastIndex=n)):n<i&&(n<sectionsFirstIndex&&(sectionsFirstIndex=n),i>sectionsLastIndex&&(sectionsLastIndex=i)),y(sections,i,n),v()}})}),o(),s(!1),i.slideDown("fast").css("display","block");else if("section"===t.children(".type").val())!function(m){loc3=loc2=loc1=m.attr("id");var g="/api/v2/help_center/en-us/sections/"+m.attr("id")+"/articles";m.children("i.fa-angle-down, i.fa-angle-right, .categoryDrop").css({cursor:"wait"}),m.children("ul.articles").length||m.append('<ul class="articles"></ul>');articles=[],function h(){var f=!0;$.get(g).done(function(e){g=e.next_page;for(var t=0;t<e.articles.length;t++)if(!e.articles[t].draft){articles.push(e.articles[t].id);for(var n=e.articles[t].label_names.map(function(e){return e.toUpperCase()}),i="fa-eye",a="Hide",s="",l=x(e.articles[t].label_names),c=e.articles[t].label_names,o=0;o<c.length;o++)"hidden"===c[o]&&(i="fa-eye-slash",a="Show",s="lineTrough");var r='<li id="'+e.articles[t].id+'" class="menu-admin-article"><i class="fas fa-grip-vertical"></i></i><div class="item-name"><a class="article '+s+' link-zendesk" href="'+zendeskEditorURL+"/articles/"+e.articles[t].id+'" target="_blank">'+e.articles[t].name+"</a></div>"+l+'<select class="type" disabled><option value="article">Article</option><option value="text">Text</option><option value="category">Category</option><option value="section">Section</option><option value="custom">Custom</option></select><a class="article-visibility" title="'+a+'"><i class="fa '+i+'" style="font-size: 20px;"></i></a><ul style="display:none;"></ul></li>';if(n.includes("LOC_1")||n.includes("LOC_2")||n.includes("LOC_3")||n.includes("LOC_4")||n.includes("LOC_5")){if(n.includes("LOC_2"))loc2=e.articles[t].id,loc3=0,0,$("#mainUL #"+loc1).children("ul").addClass("LOC_2").append(r),0===$("#mainUL #"+loc1).children("i.fa-angle-right").length&&0===$("#mainUL #"+loc1).children("i.fa-angle-down").length&&($('<i class="fa fa-angle-right" style="font-size: 16px;"></i>').insertAfter($("#mainUL #"+loc1).children("i.fa-grip-vertical")),$("#mainUL #"+loc1).children("a.article").css("padding-left","0px"));else if(n.includes("LOC_3")){loc3=e.articles[t].id,0;var d=loc2;d||(d=loc1),$("#mainUL #"+d).children("ul").addClass("LOC_3").append(r),0===$("#mainUL #"+d).children("i.fa-angle-right").length&&0===$("#mainUL #"+loc1).children("i.fa-angle-down").length&&($('<i class="fa fa-angle-right" style="font-size: 16px;"></i>').insertAfter($("#mainUL #"+d).children("i.fa-grip-vertical")),$("#mainUL #"+d).children("a.article").css("padding-left","0px"))}else if(n.includes("LOC_4")){var p=loc3;p||(p=loc2),p||(p=loc1),$("#mainUL #"+p).children("ul").addClass("LOC_4").append(r),0===$("#mainUL #"+p).children("i.fa-angle-right").length&&0===$("#mainUL #"+loc1).children("i.fa-angle-down").length&&($('<i class="fa fa-angle-right" style="font-size: 16px;"></i>').insertAfter($("#mainUL #"+p).children("i.fa-grip-vertical")),$("#mainUL #"+p).children("a.article").css("padding-left","0px"))}}else m.children("ul").addClass("LOC_1").append(r),loc1=e.articles[t].id,loc2=0,loc3=0,0}if(null===g){m.children(".fa-angle-right, .fa-angle-down, .categoryDrop").css({cursor:"pointer"});var u="";$("ul.articles").nestedSortable({forcePlaceholderSize:!0,expandOnHover:150,items:"li",placeholder:"ui-state-highlight",maxLevels:5,listType:"ul",opacity:1,isTree:!0,handle:".fa-grip-vertical",isAllowed:function(e,t,n){return!!e.parents("ul.articles").length},start:function(e,t){var n=t.item[0].id;u=I(n)},relocate:function(e,t){var n=t.item[0].id,i=C(n),a=w(n);f&&(oldIndex<newIndex?(oldIndex=i,newIndex=a):(oldIndex=a,newIndex=i),f=!1),newIndex=i<a?(oldIndex=oldIndex<i?oldIndex:i,newIndex>a?newIndex:a):(oldIndex=oldIndex<a?oldIndex:a,newIndex>i?newIndex:i),y(articles,i,a);var s=I(n);u!=s&&T({id:n,loc:s}),S(),v(),articleUpdate=!0}})}else h()})}()}(t),s(!1),i.slideDown("fast").css("display","block");else if("article"===t.children(".type").val()){s(!1);t.next(".label").text();"block"===t.parent().children("li.article").css("display")?t.parent().children("li.article").slideDown().css("display","none"):t.parent().children("li.article").slideDown().css("display","block")}function s(e){e?t.children("i.fa-angle-down").toggleClass("fa-angle-right").toggleClass("fa-angle-down"):t.children("i.fa-angle-right").toggleClass("fa-angle-right").toggleClass("fa-angle-down")}}),$("body").on("click","a.addNewButton",function(){e($(this)),f("text",$(this).parent()),$(this).remove()}),$("body").on("click","a.add-child-button",function(){e($(this)),f("category",$(this).parent()),$(this).parent().children(".saveButton").attr("class","save-child-button"),$(this).parent().children(".cancelButton").attr("class","cancel-child-button"),$(this).parent().children(".type")[0][0].remove(),$(this).remove()}),$("body").on("click","a.cancelButton",function(){$(this).parent().append('<a class="addNewButton">+ ADD</a>'),$(this).parent().children("input, a.save-child-button,a.saveButton,a.cancelButton, select, .select2").remove()}),$("body").on("click","a.cancel-child-button",function(){$(this).parent().append('<a class="add-child-button">+ ADD</a>'),$(this).parent().children("input, a.save-child-button,a.cancel-child-button, select, .select2").remove()}),$("body").on("change","li.addNew select.type",function(){f($(this).find(":selected").val(),$(this).parent())}),$("body").on("click",".menuManagement .saveButton",function(){var e=$(this).parent();if(confirm("Save "+e.children(".type").val()+" ?")){var t=g(e,currentItems.length-1);currentItems.splice(currentItems.length-1,0,t),e.append('<a class="addNewButton">+ ADD</a>'),e.children("input,a.saveButton,a.cancelButton, select, .select2").remove(),$('<li id="'+t.id+'"><i class="fas fa-grip-vertical ui-sortable-handle"></i><i class="fa fa-angle-right" style="font-size: 16px;"></i><div class="item-name"><a class="categoryDrop " target="_blank">'+t.title+'</a></div><select class="type" id="64fe707b-54cf-4ecc-ab4c-82e14651007a" disabled="disabled"><option value="text">Text</option><option value="category">Category</option><option value="section">Section</option><option value="custom">Custom</option></select><a class="parent-visibility" title="Hide"><i class="fa fa-eye" style="font-size: 20px;"></i></a><a class="editButton" title="Edit"><i class="fas fa-pen" style="font-size: 20px;"></i></a><a class="deleteButton" title="Delete"><i class="fa fa-trash" style="font-size: 20px;"></i></a><a class="editSaveButton" title="Save"><i class="fa fa-check" style="font-size: 20px;"></i></a><a class="editCancelButton" title="Cancel"><i class="fa fa-times" style="font-size: 20px;"></i></a><ul style="display:none;"><li class="addNew"><a class="add-child-button">+ ADD</a></li></ul></li>').insertBefore($("#mainUL").children().last()),$("#"+t.id).children("select").val(t.type),$("#"+t.id).children("i, a").css({"pointer-events":"none"}),document.getElementById(t.id).title="Save First To Perform Actions",d(),v()}}),$("body").on("click",".menuManagement .save-child-button",function(){var e=$(this).parent();if(confirm("Save "+e.children("select.type").val()+"?")){var t=e.parent().parent().index(),n=g(e,currentItems[t-1].children.length);currentItems[t-1].children.push(n),lastModifiedParent=e.parent().parent().attr("id"),e.append('<a class="add-child-button">+ ADD</a>'),e.children("input, a.save-child-button,a.cancel-child-button, select, .select2").remove(),$('<li id="'+n.id+'"><i class="fas fa-grip-vertical ui-sortable-handle"></i><i class="fa fa-angle-right" style="font-size: 16px;"></i><div class="item-name"><a class="categoryDrop link-zendesk" href="/hc/admin/categories/200363119/edit" target="_blank">'+n.title+'</a></div><select class="type" disabled="disabled"><option value="category">Category</option><option value="text">Text</option><option value="section">Section</option><option value="custom">Custom</option></select><a class="child-visibility" title="Hide"><i class="fa fa-eye" style="font-size: 20px;"></i></a><a class="edit-child-button" title="Edit"><i class="fas fa-pen" style="font-size: 20px;"></i></a><a class="delete-child-button" title="Delete"><i class="fa fa-trash" style="font-size: 20px;"></i></a><a class="edit-save-child" title="Save"><i class="fa fa-check" style="font-size: 20px;"></i></a><a class="cancel-edit-child" title="Cancel"><i class="fa fa-times" style="font-size: 20px;"></i></a></li>').insertBefore(e.parent().children().last()),$("#"+n.id).children("select").val(n.type),$("#"+n.id).find("i, a").css({"pointer-events":"none"}),document.getElementById(n.id).title="Save First To Perform Actions",d(),v()}}),$("body").on("click",".menuManagement .editButton",function(){var e=$(this).parent();e.children(".item-name, .fa").css("display","none"),e.children(".type").toggleClass("currentSelect"),e.children("select").removeAttr("disabled").css("background-color","#ffffff"),dropdownValue=e.children("select.type").val(),f(e.children("select.type").find(":selected").text().toLowerCase(),e),e.children("a.editButton, a.deleteButton").css("display","none"),e.children("a.editSaveButton, a.editCancelButton").css("display","inline")}),$("body").on("change",".menuManagement .currentSelect",function(){f($(this).find(":selected").text().toLowerCase(),$(this).parent())}),$("body").on("click",".menuManagement .editSaveButton",function(){if(confirm("Edit "+$(this).parent().children("select.type").val()+" ?")){for(var e=currentItems.length,t=!0,n={},i=$(this).parent(),a=i.attr("id"),s=0;t&&s<e;s++)currentItems[s].id==a&&(editChildren=currentItems[s].children,n=g(i,s),currentItems[s]=n,d(),v(),l(i),i.attr({id:n.id,title:"Save First To Perform Actions"}),i.children("select").attr("id",n.id).val(n.type),i.children(".item-name").children("a").text(n.title),i.children("i, a").css({"pointer-events":"none"}),t=!1);$(this).parent().children("select").attr("disabled","disabled")}}),$("body").on("click",".menuManagement .editCancelButton",function(){l($(this).parent())}),$("body").on("click",".menuManagement .deleteButton",function(){if(confirm("Delete "+$(this).parent().children(".type").val()+"?"))for(var e=$(this).parent().attr("id"),t=!0,n=0;n<currentItems.length&&t;n++)e==currentItems[n].id&&(currentItems.splice(n,1),d(),v(),$("#mainUL #"+e).remove(),t=!1)}),$("body").on("click",".delete-child-button",function(){var e=$(this).parent();confirm("Delete "+e.children("select.type").val()+"?")&&(s($(this).parent()),lastModifiedParent=e.parent().parent().attr("id"),d(),v(),$(this).parent().remove())}),$("body").on("click",".edit-child-button",function(){var e=$(this).parent(),t=e.parent().parent().index()-1;e.css("height","40px"),currentItems[t].children[e.index()-1].checkItem=!0,e.children("label.toggle-text").css("display","inline").show(),e.children(".item-name, .fa").css("display","none"),e.children(".type").toggleClass("currentSelect"),$('input[type="checkbox"]').click(function(){1==$(this).prop("checked")?(currentItems[t].children[e.index()-1].checkItem=!0,v()):0==$(this).prop("checked")&&(currentItems[t].children[e.index()-1].checkItem=!1,v())}),e.children("select").removeAttr("disabled").css("background-color","#ffffff"),dropdownValue=e.children("select.type").val(),f(e.children("select.type").find(":selected").text().toLowerCase(),e),e.children(".edit-save-child, .cancel-edit-child").css("display","inline"),e.children(".edit-child-button, .delete-child-button").css("display","none")}),$("body").on("click",".cancel-edit-child",function(){a($(this).parent())}),$("body").on("click",".edit-save-child",function(){var e=$(this).parent();if(confirm("Edit "+e.children("select.type").val()+"?")){var t=e.parent().parent().index(),n=s(e),i=g(e,n);currentItems[t-1].children.splice(n,0,i),lastModifiedParent=e.parent().parent().attr("id"),a(e),d(),v(),e.attr({id:i.id,title:"Save First To Perform Actions"}),e.children("select").attr("id",i.id).val(i.type),e.children(".item-name").children("a").text(i.title),e.children("i, a").css({"pointer-events":"none"})}}),$("body").on("click","#save-changes",function(){var e=7;doneRequest=0,$mainWrapper.css({opacity:".4"}),$("main").append('<div id="loader" ><img class="image-loader" src="'+gSZMKspingreyGIFURL+'"/><label>Please wait...</label></div>'),function(){sectionsToHide.length||doneRequest++;for(var e=0,t=sectionsToHide.length;e<t;e++)!function(n){$.get("/api/v2/help_center/sections/"+sectionsToHide[n]).done(function(e){var t=""==e.section.description?"hidden":e.section.description+" hidden";$.ajax({url:"/api/v2/help_center/sections/"+sectionsToHide[n],type:"PUT",data:{section:{description:t}}}).done(function(){n+1>=sectionsToHide.length&&doneRequest++})})}(e)}(),function(){sectionsToShow.length||doneRequest++;for(var e=0,t=sectionsToShow.length;e<t;e++)!function(n){$.get("/api/v2/help_center/sections/"+sectionsToShow[n]).done(function(e){var t=e.section.description.replace(/hidden/g,"");t=t.trim(),$.ajax({url:"/api/v2/help_center/sections/"+sectionsToShow[n],type:"PUT",data:{section:{description:t}}}).done(function(){n+1>=sectionsToShow.length&&doneRequest++})})}(e)}(),function(){articlesToHide.length||doneRequest++;articlesToHide.forEach(function(e,t){$.ajax({url:"/api/v2/help_center/articles/"+e+"/labels.json",type:"POST",data:{label:{name:"hidden"}}}).done(function(){t+1>=articlesToHide.length&&doneRequest++})})}(),function(){articlesToShow.length||doneRequest++;for(var e=0,t=articlesToShow.length;e<t;e++)!function(a){$.get("/api/v2/help_center/articles/"+articlesToShow[a]+"/labels.json").done(function(e){for(var t=e.labels,n=0,i=t.length;n<i;n++)"hidden"==t[n].name&&$.ajax({url:"/api/v2/help_center/en-us/articles/"+articlesToShow[a]+"/labels/"+t[n].id+".json",type:"DELETE"}).done(function(){a+1>=articlesToShow.length&&doneRequest++})})}(e)}(),JSON.stringify(menuObj)!==menuCopy&&($.ajax({url:"/api/v2/help_center/articles/"+siteMap+"/translations/en-us.json",type:"PUT",dataType:"json",contentType:"application/json",data:JSON.stringify({translation:{body:JSON.stringify(menuObj)}})}).done(function(){doneRequest++,m(),i()}),e++),function(){var e=oldIndex,t=newIndex,n=[];if((t=oldIndex<newIndex?(e=oldIndex,newIndex):(e=newIndex,oldIndex))!=e){for(;e<=t;e++)i=e,a=void 0,a=$.ajax({url:"/api/v2/help_center/articles/"+articles[i]+".json",type:"PUT",dataType:"json",contentType:"application/json",data:JSON.stringify({article:{position:e}})}),n.push(a);$.when.apply(null,n).done(function(){doneRequest++})}var i,a}(),function(){for(var a=[],s=[],e=articlesChangeLOC.length,l=0;l<e;l++)!function(n){if(null!=articlesChangeLOC[n].labels)for(var i=articlesChangeLOC[n].labels,e=0;e<i.length;e++)!function(e){if(i[e].name.includes("LOC")){var t=$.ajax({url:"/api/v2/help_center/articles/"+articlesChangeLOC[n].id+"/labels/"+i[e].id+".json",type:"DELETE"});s.push(t)}}(e);if(""!=articlesChangeLOC[l].loc){var t=$.ajax({url:"/api/v2/help_center/articles/"+articlesChangeLOC[n].id+"/labels.json",type:"POST",data:{label:{name:articlesChangeLOC[l].loc}}});a.push(t)}}(l);$.when.apply(null,s).done(function(){$.when.apply(null,a).done(function(){$("#save-changes").attr("disabled","disabled"),doneRequest++})})}(),function(){if(sectionsFirstIndex!==sectionsLastIndex){for(var e=[],t=sectionsFirstIndex;t<=sectionsLastIndex;t++){var n=$.ajax({url:"/api/v2/help_center/sections/"+sections[t].id,type:"PUT",data:{section:{position:t}}});e.push(n)}$.when.apply(null,e).done(function(){$("#save-changes").attr("disabled","disabled"),doneRequest++})}}(),d(),$(this).prop("disabled","disabled"),setTimeout(function(){!function(){e>=doneRequest?($mainWrapper.css({opacity:"1"}),$("#loader").remove()):setTimeout(arguments.callee,100)}()},1e3)}),$("body").on("click",".enabled",function(){$(this).attr("disabled","disabled");var s=$(this).parent().attr("id"),l=$(this).attr("class").split(" ")[0],c=[],o=[];n(s).done(function(e){for(var t=0;t<e.labels.length;t++){var n=e.labels[t].name;if(n.includes(l)){n=n.replace(/tags:/g,"");var i=$.ajax({url:"/api/v2/help_center/en-us/articles/"+s+"/labels/"+e.labels[t].id+".json",type:"DELETE"});o.push(i);var a=$.ajax({url:"/api/v2/help_center/articles/"+s+"/labels.json",type:"POST",data:{label:{name:"DT:"+n}}});c.push(a)}}}),$(this).removeClass("enabled").addClass("disabled"),$("#products").val().toLowerCase()==l.toLowerCase()&&($(this).parent().find(".article ").addClass("lineTrough"),$(this).parent().children(".article-visibility").children("i").hasClass("fa-eye")&&$(this).parent().children(".article-visibility").children("i").toggleClass("fa-eye").toggleClass("fa-eye-slash")),$(this).removeAttr("disabled")}),$("body").on("click",".disabled",function(){$(this).attr("disabled","disabled");var a=$(this).parent().attr("id"),s="DT:"+$(this).attr("class").split(" ")[0],l=$(this).attr("class").split(" ")[0];n(a).done(function(e){for(var t=0;t<e.labels.length;t++)if(e.labels[t].name==s){e.labels[t].name;(n=a,i=e.labels[t].id,$.ajax({url:"/api/v2/help_center/en-us/articles/"+n+"/labels/"+i+".json",type:"DELETE"})).done(function(){c(a,l,!1)})}var n,i}),$(this).removeClass("disabled").addClass("enabled"),$(this).parent().find(".article ").removeClass("lineTrough"),$(this).parent().children(".article-visibility").children("i").hasClass("fa-eye-slash")&&$(this).parent().children(".article-visibility").children("i").toggleClass("fa-eye").toggleClass("fa-eye-slash"),$(this).removeAttr("disabled")}),$("body").on("click",".parent-visibility",function(){$(this).attr("disabled","disabled");var e=$(this).children("i.fa").hasClass("fa-eye")?0:1;currentItems[$(this).parent().index()-1].v=e,$(this).children("i.fa").toggleClass("fa-eye-slash").toggleClass("fa-eye"),v()}),$("body").on("click",".child-visibility",function(){$(this).attr("disabled","disabled");var e=$(this).children("i.fa").hasClass("fa-eye")?0:1,t=$(this).parent().parent().parent().index()-1;currentItems[t].children[$(this).parent().index()-1].v=e,lastModifiedParent=currentItems[t].id,$(this).children("i.fa").toggleClass("fa-eye-slash").toggleClass("fa-eye"),v()}),$("body").on("checked",".child-"),$("body").on("click",".section-visibility",function(){var e,t=$(this),n=$(this).parent(),i=n.attr("id");(t.addClass("unclickable"),$(this).children(".fa").hasClass("fa-eye"))?(-1<(e=sectionsToShow.indexOf(i))?sectionsToShow.splice(e,1):sectionsToHide.includes(i)||sectionsToHide.push(i),n.find(".categoryDrop").addClass("lineTrough")):(-1<(e=sectionsToHide.indexOf(i))?sectionsToHide.splice(e,1):sectionsToShow.includes(i)||sectionsToShow.push(i),n.find(".categoryDrop").removeClass("lineTrough"));t.removeClass("unclickable").children(".fa").toggleClass("fa-eye-slash").toggleClass("fa-eye"),v()}),$("body").on("click",".article-visibility",function(){var e,t=$(this).parent().attr("id");$(this).children(".fa").hasClass("fa-eye")?(-1<(e=articlesToShow.indexOf(t))?articlesToShow.splice(e,1):articlesToHide.includes(t)||articlesToHide.push(t),$(this).parent().find(".article ").addClass("lineTrough")):(-1<(e=articlesToHide.indexOf(t))?articlesToHide.splice(e,1):articlesToShow.includes(t)||articlesToShow.push(t),$(this).parent().find(".article ").removeClass("lineTrough"));$(this).children("i.fa").toggleClass("fa-eye-slash").toggleClass("fa-eye");var n=$(this).parent(),i=n.parent(".articles").parent();n.parent().find(".fa-eye").length<1?(i.find(".fa-eye").toggleClass("fa-eye-slash").toggleClass("fa-eye"),i.find(".categoryDrop").addClass("lineTrough")):i.find(".lineTrough").length<0&&(n.parent("ul.articles").prev(".section-visibility").children(".fa").removeClass("fa-eye-slash"),i.find(".categoryDrop").removeClass("lineTrough"),!n.parent(".articles").prev(".section-visibility").children(".fa").hasClass("fa-eye")&&n.parent(".articles").prev(".section-visibility").children(".fa").addClass("fa-eye")),v()})}function n(e){return $.get("/api/v2/help_center/en-us/articles/"+e+"/labels.json")}function c(e,t,n){var i=t;if(n)i="DT:"+t;return $.ajax({url:"/api/v2/help_center/articles/"+e+"/labels.json",type:"POST",data:{label:{name:i}}})}function s(e){for(var t=e.attr("id"),n=currentItems[e.parent().parent().index()-1].children,i=0;i<n.length;i++)if(t==n[i].id)return currentItems[e.parent().parent().index()-1].children.splice(i,1),i}function i(){$.get("/api/v2/help_center/en-us/articles/"+siteMap).done(function(e){menuCopy=e.article.body,menuObj=JSON.parse(strip_html_tags(e.article.body)),$("article").css("display","none"),$mainWrapper.children("ul, li").remove(),$("#products").is(":visible")||function(){for(var e='<select id="products">',t=0;t<menuObj.products.length;t++)e+='<option value="'+menuObj.products[t].value+'">'+menuObj.products[t].text+"</option>";$mainWrapper.append(e+"</select>");var n=(i=storage.getItem("global-filterSetting"),"mdx_2_0"===i?"mdx2":"mdx_nxt"===i?"sas":"newdsp"==i?"newDsp":"dsp"===i?"dsp":"dmp"===i?"dmp":"support_kb"===i?"supportKb":"mdx2");var i;$("#products").val(n)}(),r(),p(),o(),$("#"+lastModifiedParent).children("i").click(),$mainWrapper.children("ul").prepend(t)})}function o(){$(".type, .visibility").attr("disabled","disabled")}function r(){var e=$("select#products option:selected").val();"mdx2"===e?currentItems=menuObj.mdx2:"sas"===e?currentItems=menuObj.sas:"newDsp"===e?currentItems=menuObj.newDsp:"dsp"===e?currentItems=menuObj.dsp:"dmp"===e?currentItems=menuObj.dmp:"supportKb"===e&&(currentItems=menuObj.supportKb)}function d(){var e=$("select#products option:selected").val();"mdx2"===e?menuObj.mdx2=currentItems:"sas"===e?menuObj.sas=currentItems:"newDsp"===e?menuObj.newDsp=currentItems:"dsp"===e?menuObj.dsp=currentItems:"dmp"===e?menuObj.dmp=currentItems:"supportKb"===e&&(menuObj.supportKb=currentItems)}function p(){$("select#products option:selected").val();var e=currentItems.length;$mainWrapper.append('<ul class="menuManagement" id="mainUL"></ul>');for(var t=0;t<e;t++)if(null!=currentItems[t]&&($(".menuManagement").append(h(currentItems[t])),void 0!==currentItems[t].children)){for(var n="",i=0;i<currentItems[t].children.length;i++)n+=h(currentItems[t].children[i],!0);$("#children-"+currentItems[t].id).append('<li class="addNew"><a class="add-child-button">+ ADD</a></li>'+n).css("display","none")}$("#mainUL").nestedSortable({items:" > li:not(.addNew)",placeholder:"ui-state-highlight",listType:"ul",disableParentChange:!0,protectRoot:!0,handle:".fa-grip-vertical",update:function(e,t){var n=currentItems.findIndex(function(e){return e.id==t.item[0].id});y(currentItems,n,$("#mainUL #"+t.item[0].id).index()-1),v()}}),$("ul.sublist").nestedSortable({disableParentChange:!0,protectRoot:!0,items:" > li:not(.addNew)",placeholder:"ui-state-highlight",listType:"ul",handle:".fa-grip-vertical",update:function(e,t){var n=$("#mainUL #"+t.item[0].id).parent().parent().index()-1,i=currentItems[n].children.findIndex(function(e){return e.id==t.item[0].id});y(currentItems[n].children,i,$("#mainUL #"+t.item[0].id).index()-1),lastModifiedParent=$("#mainUL #"+t.item[0].id).parent().parent().attr("id"),v()}}),$(".menuManagement .fa-grip-vertical").on("mousedown",function(e){e.preventDefault(),$(this).addClass("mouseDown")}).on("mouseup",function(){$(this).removeClass("mouseDown")})}function v(){articlesToShow.length||articlesToHide.length||sectionsToShow.length||sectionsToHide.length||JSON.stringify(menuObj)!==menuCopy||sections.length||articles.length||articlesChangeLOC.length?($("#save-changes").removeAttr("disabled"),window.addEventListener("beforeunload",u)):($("#save-changes").prop("disabled","disabled"),window.removeEventListener("beforeunload",u))}function u(){return""}function y(e,t,n){for(;t<0;)t+=e.length;for(;n<0;)n+=e.length;if(n>=e.length)for(var i=n-e.length;1+i--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}function h(e,t){var n="",i="",a="",s="sublist",l="text"!=e.type?"link-zendesk":"",c=t?"child-visibility":"parent-visibility",o="Show",r="fa-eye-slash",d='<select class="type" id="'+e.id+'"><option value="text">Text</option><option value="category">Category</option><option value="section">Section</option><option value="custom">Custom</option></select>';e.v&&(r="fa-eye",o="Hide"),"category"==e.type?(d='<select class="type" id="'+e.id+'"><option value="category">Category</option><option value="text">Text</option><option value="section">Section</option><option value="custom">Custom</option></select>',s="sections"):"section"==e.type?(d='<select class="type" id="'+e.id+'"><option value="section">Section</option><option value="text">Text</option><option value="category">Category</option><option value="custom">Custom</option></select>',s="articles"):"custom"==e.type&&(d='<select class="type" id="'+e.id+'"><option value="custom">Custom</option><option value="text">Text</option><option value="category">Category</option><option value="section">Section</option></select>');var p='<a class="'+c+'" title="'+o+'"><i class="fa '+r+'" style="font-size: 20px;"></i></a><a class="edit-child-button" title="Edit"><i class="fas fa-pen" style="font-size: 20px;"></i></a><a class="delete-child-button" title="Delete"><i class="fa fa-trash" style="font-size: 20px;"></i></a><a class="edit-save-child" title="Save"><i class="fa fa-check" style="font-size: 20px;"></i></a><a class="cancel-edit-child" title="Cancel"><i class="fa fa-times" style="font-size: 20px;"></i></a><ul class="'+s+'" id="children-'+e.id+'"></ul>';if(t||(p='<a class="'+c+'" title="'+o+'"><i class="fa '+r+'" style="font-size: 20px;"></i></a><a class="editButton" title="Edit"><i class="fas fa-pen" style="font-size: 20px;"></i></a><a class="deleteButton" title="Delete"><i class="fa fa-trash" style="font-size: 20px;"></i></a><a class="editSaveButton" title="Save"><i class="fa fa-check" style="font-size: 20px;"></i></a><a class="editCancelButton" title="Cancel"><i class="fa fa-times" style="font-size: 20px;"></i></a><ul class="'+s+'" id="children-'+e.id+'"></ul></li>'),"custom"===e.type){if(i="href="+e.url,a='<label class="toggle-text" style="display:none;"><input label="New Tab" class="open-tab" type="checkbox" ><span>OPEN NEW TAB</span></label>',e.checkItem){var u=' target="_blank"';a='<label class="toggle-text" style="display:none;"><input label="New Tab" class="open-tab" type="checkbox" checked><span >OPEN NEW TAB</span></label>'}else if(e.checkItem)u=">"}else n='<i class="fa fa-angle-right" style="font-size: 16px;"></i>',"text"!=e.type&&(i="category"==e.type?'href="/hc/admin/categories/'+e.id+'/edit"':'href="/hc/admin/'+e.type+"s/"+e.id+'/edit"');return'<li id="'+e.id+'"><i class="fas fa-grip-vertical"></i>'+n+'<div class="item-name"><a class="categoryDrop '+l+'" '+i+u+">"+e.title+"</a></div>"+a+d+p}function f(e,t){console.log(e);var n=JSON.parse(storage.getItem(HelpCenter.user.email+"-allCategories"+helpCenterVer+currentLang)),i=n.length;if($(".menuManagement .select2").remove(),"text"==e){var a='<input type="text" placeholder="Text..">';$(".menuManagement #categoryDropdown").remove(),$(".menuManagement #sectionDropdown").remove(),$(".menuManagement input").remove(),$(a).insertAfter(t.find(".editCancelButton")),$(a).insertAfter(t.find(".cancelButton")),$(a).insertAfter(t.find(".cancel-child-button")),$(a).insertAfter(t.find(".cancel-edit-child")),t.children('input[type="text"]').val(t.children(".item-name").children("a.categoryDrop").text())}else if("category"===e){for(var s='<select id="categoryDropdown">',l=0;l<i;l++)s+='<option value="'+n[l].id+'">'+n[l].name+"</option>";s+="</select>",t.children("input").remove(),$(".menuManagement #sectionDropdown").remove(),$(s).insertAfter(t.find(".editCancelButton")),$(s).insertAfter(t.find(".cancelButton")),$(s).insertAfter(t.find(".cancel-child-button")),$(s).insertAfter(t.find(".cancel-edit-child")),$(".menuManagement #categoryDropdown").val(t.attr("id")).select2({placeholder:"Select a category"})}else if("section"===e){for(var c=JSON.parse(storage.getItem(HelpCenter.user.email+"-allSections"+helpCenterVer+currentLang)),o=c.length,r='<select id="sectionDropdown">',d=0;d<i;d++){for(var p="",u=0;u<o;u++)n[d].id===c[u].category&&(p+='<option class="'+n[d].id+'" value="'+c[u].id+'">'+c[u].name+"</option>");p&&(r+='<optgroup class="'+n[d].id+'" label="'+n[d].name+'">'+p+"</optgroup>")}r+="</select>",t.children("input").remove(),$(".menuManagement #categoryDropdown").remove(),$(r).insertAfter(t.find(".editCancelButton")),$(r).insertAfter(t.find(".cancelButton")),$(r).insertAfter(t.find(".cancel-child-button")),$(r).insertAfter(t.find(".cancel-edit-child")),$(".menuManagement #sectionDropdown").val(t.attr("id")).select2({placeholder:"Select a section"}),$("#sectionDropdown").children("option").wrap("<span/>")}else if("custom"===e){var h='<input type="text" placeholder="Text..."><input type="url" placeholder="URL...">';t.children('input[type="text"]').remove(),$(".menuManagement #categoryDropdown").remove(),$(".menuManagement #sectionDropdown").remove(),$(h).insertAfter(t.find(".editCancelButton")),$(h).insertAfter(t.find(".cancelButton")),$(h).insertAfter(t.find(".cancel-child-button")),$(h).insertAfter(t.find(".cancel-edit-child")),t.children('input[type="text"]').val(t.find(".categoryDrop").text()),t.children('input[type="url"]').val(t.find(".categoryDrop").attr("href"))}}function m(){$("#save-changes").attr("disabled","disabled"),$mainWrapper.children("ul, li").remove(),r(),p(),$mainWrapper.children("ul").prepend(t)}function g(e,t){var n=e.children("select.type").val(),i=e.children('input[type="text"]').val(),a=e.children("select#categoryDropdown"),s=e.children("select#sectionDropdown"),l="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)});a.is(":visible")&&(i=a.find(":selected").text(),l=parseInt(a.find(":selected").val())),s.is(":visible")&&(i=s.find(":selected").text(),l=parseInt(s.find(":selected").val()));var c={title:i,id:l,position:t,type:n,v:1};return"text"===n&&(c.children=editChildren),"custom"===n&&(c.url=e.children('input[type="url"]').val()),c}function b(e){for(var t=0;t<e.length;t++)if(!e[t].draft)return!1;return!0}function x(e){for(var t=e.length,n="",i=0;i<t;i++)e[i].includes("DT")||!e[i].includes("mdx2")&&!e[i].includes("kbmdx")?e[i].includes("DT")&&(e[i].includes("mdx2")||e[i].includes("kbmdx"))&&(e[i].includes("kbmdx")?n+='<span class="kbmdx disabled">MDX 2.0</span>':n+='<span class="mdx2 disabled">MDX 2.0</span>'):e[i].includes("kbmdx")?n+='<span class="kbmdx enabled">MDX 2.0</span>':n+='<span class="mdx2 enabled">MDX 2.0</span>',(e[i].includes("mdxnxt")||e[i].includes("kbmdxnxt")||e[i].includes("kbsas"))&&!e[i].includes("DT")?e[i].includes("mdxnxt")?n+='<span class="mdxnxt enabled">SAS</span>':e[i].includes("kbmdxnxt")?n+='<span class="kbmdxnxt enabled">SAS</span>':e[i].includes("kbsas")&&(n+='<span class="kbsas enabled">SAS</span>'):e[i].includes("DT")&&(e[i].includes("mdxnxt")||e[i].includes("kbmdxnxt")||e[i].includes("kbsas"))&&(e[i].includes("mdxnxt")?n+='<span class="mdxnxt disabled">SAS</span>':e[i].includes("kbmdxnxt")?n+='<span class="kbmdxnxt disabled">SAS</span>':e[i].includes("kbsas")&&(n+='<span class="kbsas disabled">SAS</span>')),"newdsp"!=e[i]||e[i].includes("DT")?"newdsp"==e[i]&&e[i].includes("DT")&&(n+='<span class="newdsp disabled">NEW DSP</span>'):n+='<span class="newdsp enabled">NEW DSP</span>',"dsp"!=e[i]||e[i].includes("DT")?"dsp"==e[i]&&e[i].includes("DT")&&(n+='<span class="dsp disabled">DSP</span>'):n+='<span class="dsp enabled">DSP</span>',e[i].includes("dmp")&&!e[i].includes("DT")?n+='<span class="dmp enabled">DMP</span>':e[i].includes("dmp")&&e[i].includes("DT")&&(n+='<span class="dmp disabled">DMP</span>');return n}function C(e){for(var t=articles.length,n=0;n<t;n++){if(articles[n]==e){return n}}}function w(e){for(var t=$("#mainUL #"+e).parentsUntil("ul.articles","ul"),n=0,i=$("#mainUL #"+e).prevAll("li.menu-admin-article"),a=0;a<i.length;a++){n+=$(i[a]).find("li").addBack().length}for(var s=0;s<t.length;s++){n+=$(t[s]).parent().prevAll("li.menu-admin-article").addBack().length;i=$(t[s]).parent().prevAll("li.menu-admin-article");for(var a=0;a<i.length;a++){n+=$(i[a]).find("li").length}}return n}function I(e){var t=$("#mainUL #"+e).parentsUntil("ul.articles","ul");return t.length<1?"":"LOC_"+(t.length+1)}function T(e){for(var t=true,n=0;n<articlesChangeLOC.length;n++){if(articlesChangeLOC[n].id===e.id){t=false;articlesChangeLOC[n].loc=e.loc}}t&&articlesChangeLOC.push({id:e.id,loc:e.loc})}function S(){for(var e=articlesChangeLOC.length,t=0;t<e;t++){(function(t){if(undefined===articlesChangeLOC[t].labels){$.get("/api/v2/help_center/articles/"+articlesChangeLOC[t].id+"/labels.json").done(function(e){articlesChangeLOC[t].labels=e.labels})}})(t)}}});