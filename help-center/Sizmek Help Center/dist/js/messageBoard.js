$(document).ready(function(){var p=HelpCenter.user.role,m=window.localStorage,e=JSON.parse(m.getItem("platforms")),t=window.location.href.split("/"),n=t[t.length-1].split("-",1).toString();if(-1<window.location.href.indexOf("categories/"+messageBoardCategory)||-1!==jQuery.inArray(n,e)){$(".section-tree").html("");var u=messageBoardCategory,d=201822986,w=messageBoardSAS,a=messageBoardInternal,i=globalNotification_ID,o=globalSupport_ID,E=["#7EDE96","#3498DB","#FFD24D","#DC7633","#E74C3C"],v=["Operational","Under Maintenance","Degraded Performance","Partial Outage","Major Outage"],r=!1,b=[],h=[],f=[],S="",g=0,k="",I="",s=0,l=0,c=0,T=0,_=0,M=0,C=[],D=[],A=!1,O=!1,P=!1,j="",R=[],N=[];function B(e){return"RESOLVED"===e?'<span class="label label-success" id="category-page-label">'+e+"</span>":"COMPLETED"===e?'<span class="label label-success" id="category-page-label">'+e+"</span>":"INVESTIGATING"===e?'<span class="label label-warning" id="category-page-label">'+e+"</span>":"IDENTIFIED"===e?'<span class="label label-inverse" id="category-page-label">'+e+"</span>":"MONITORING"===e?'<span class="label label-info" id="category-page-label">'+e+"</span>":"NEW"===e?'<span class="label" id="category-page-label">'+e+"</span>":"UPDATED"===e?'<span class="label label-info" id="category-page-label">'+e+"</span>":""}function U(e){return{url:"/api/v2/help_center/sections/"+e+"/subscriptions.json",type:"POST",data:{subscription:{source_locale:"en-us",include_comments:!0,user_id:i}}}}function F(){$("#loader-container").hasClass("hide")||$("#loader-container").addClass("hide")}function H(){$("#loader-container").removeClass("hide")}function L(){return $.get("/api/v2/help_center/user_segments.json")}function z(){var t='<select class="segments-select">';return D.forEach(function(e){t+='<option value="'+e.id+'">'+e.name+"</option>"}),t+"</select>"}function K(e,t){return{url:"/api/v2/help_center/articles/"+e,type:"PUT",data:{article:{user_segment_id:t}}}}function X(e,t){return{url:"/api/v2/help_center/articles/"+e+"/translations/en-us.json",type:"PUT",data:{translation:{title:t}}}}function q(e,t){return{url:"/api/v2/help_center/articles/"+e+"/labels.json",type:"POST",data:{label:{name:t}}}}function G(e,t){return{url:"/api/v2/help_center/articles/"+e+"/labels/"+t+".json",type:"DELETE"}}function V(e,t,n){return{url:"/api/v2/help_center/articles/"+e+"/comments.json",type:"POST",data:{comment:{body:t,author_id:o,locale:"en-us"},notify_subscribers:n}}}function Q(t,n,i){console.log("\nRequest: ",t[n]);var a=!1;t[n].action&&(delete t[n].action,a=!0),$.ajax(t[n]).done(function(e){a&&R.push(e.article.id),console.log("Status: %c Success ","background:#222; color:#00ff00"),"delete"!==t[n].type.toLowerCase()&&console.log("Response: ",e),n<t.length-1?Q(t,n+1,i):(C=[],console.log(j),""!=j&&R.push(j.id),function e(t,n,i){if(n<t.length){var a=t.filter(function(e){return e!==t[n]});a.length?(N.push(q(t[n],"RelatedIncidents:"+a.join(" "))),e(t,n+1,i)):(R=[],N=[],i(t[n]))}else Z(N,0,i,t[n])}(R,0,i))}).fail(function(e){console.log("Status: %c Error ","background:#222; color:#ff0000"),console.log("Response",e)})}function Z(t,n,i,a){console.log("\nRequest: ",t[n]),$.ajax(t[n]).done(function(e){console.log("Status: %c Success ","background:#222; color:#00ff00"),"delete"!==t[n].type.toLowerCase()&&console.log("Response: ",e),n<t.length-1?Z(t,n+1,i,a):(R=[],N=[],i(a))}).fail(function(e){console.log("Status: %c Error ","background:#222; color:#ff0000"),console.log("Response",e)})}if(m.getItem("category")||m.setItem("category",u),-1<window.location.href.indexOf("categories/"+u)&&$(".sub-nav").after('<img class="component-loader" src="'+gSZMKspingreyGIFURL+'" style="margin-top:85px"/><div class="main-components-container" style="width:1000px"></div>'),$(".dropdown-toggle").removeAttr("href"),history.pushState(null,null,"/hc/en-us/categories/"+messageBoardCategory),window.addEventListener("popstate",function(e){0<window.location.href.indexOf(messageBoardCategory)&&window.location.assign("/hc/en-us/categories/"+messageBoardCategory)}),HelpCenter.user.locale?($.get("/api/v2/help_center/"+HelpCenter.user.locale+"/categories/"+u+"/sections.json").done(function(e){e.sections,$(".incident-nav-cont").append('<button class="prev"></button> <a class="titles"></a> <button class="next" ></button>'),$(".subs-nav-cont").append('<button class="prev2"></button> <a class="titles2"></a> <button class="next2"></button>'),$(".prev").hide(),$(".titles").css("margin-left",180),$(".next").click(function(){$(".prev").show(),$(".titles").css("margin-left",0);var e=$(".incident-nav-item-active").next(".incident-nav-item");e.length?e.click():$(".next ").hide()}),$(".prev2").hide(),$(".titles2").css("margin-left",180),$(".prev").click(function(){var e=$(".incident-nav-item-active").prev(".incident-nav-item");$(".next ").show(),e.length?e.click():($(".prev").hide(),$(".titles").css("margin-left",180))}),$(".next2").click(function(){$(".prev2").show(),$(".titles2").css("margin-left",0);var e=$(".subs-nav-item-active").next(".subs-nav-item");e.length?e.click():$(".next2 ").hide()}),$(".prev2").click(function(){var e=$(".subs-nav-item-active").prev(".subs-nav-item");e.length?($(".next2 ").show(),e.click()):($(".prev2").hide(),$(".titles2").css("margin-left",180))});for(var t=e.count-1;0<=t;t--){var n=e.sections[t].description;if(-1<n.indexOf("@component")||-1<n.indexOf("@show_content")){var i=e.sections[t].id.toString(),a=e.sections[t].html_url,s=n.split("@",1).toString(),l=e.sections[t].user_segment_id,c=n.charAt(n.length-1),d="";if(h[i]=a,b.push(i),526203==l&&(d='<span class="visibility-internal" data-title="Only visible to agents and managers" style="margin-top: 3px"> <span class="visibility-internal-icon"></span> </span>'),-1<n.indexOf("@show_content")){$(".section-tree").prepend('<section class="section" id="'+s.replace(/\s/g,"_")+'" style="float:unset;max-width:none;width:1000px"><h3 style="margin: 10px 0px;">'+d+'<span class="releaseTag">'+n+'</span><a href="'+a+'" style="font-size:25px !important;font-weight: 300">'+s+'</a></h3><ul class="article-list article-list-'+i+'" style="min-height: 50px;"></ul></section>'),r(i),$(".incident-nav-cont").prepend('<div class="incident-nav-item">'+s+"<span>"+i+"</span></div>"),$(".incident-container").append('<div class="incident-list-cont" id="incident-'+i+'"><div class="incident-list"></div></div>'),$(".subs-nav-cont").prepend('<div class="subs-nav-item">'+s+"<span>"+i+"</span></div>"),$(".subs-container").append('<div class="subs-list-cont" id="subs-'+i+'"> <div class="subs-list-desc">Loading subscribers...</div><div class="subs-list-header"><input type="checkbox"> <div>Email Subscribers</div> <div>Date Added</div> <div>Actions</div></div><div class="subs-lists"></div> </div>');var o='<div class="component"> <input class="affected-component" type="checkbox" value='+i+"><span>"+s+"</span> </div>";-1===n.indexOf("@internal_only")&&$(".component-container").prepend(o)}-1<n.indexOf("@component")&&-1<window.location.href.indexOf("categories/"+u)&&$(".main-components-container").prepend('<div class="component" id="component-'+i+'"style="display:flex;align-items:center;">'+d+'<span class="releaseTag">'+n+'</span><a href="#'+s.replace(/\s/g,"_")+'" style="font-size:17px !important;flex:1;color:#0d2a4d">'+s+'</a><span style="color:'+E[c-1]+';float:right;font-size:17px">'+v[c-1]+'</span><a class="article-subscribe" style="margin-top:0" role="button">Follow</a><span class="hide">'+i+"</span></div>")}0==t&&(m.setItem("platforms",JSON.stringify(b)),ye())}function r(o){$.get("/api/v2/help_center/"+HelpCenter.user.locale+"/sections/"+o+"/articles.json").done(function(e){var t;t=0;for(var n=0,i=e.articles.length;n<i&&t<5;n++){if(-1==(c=e.articles[n].title).indexOf("[Template]")&&-1==jQuery.inArray("Hidden",e.articles[n].label_names)&&-1==jQuery.inArray("Archived",e.articles[n].label_names)||-1==c.indexOf("[Template]")&&-1==jQuery.inArray("Hidden",e.articles[n].label_names)&&"anonymous"!=p&&"end_user"!=p){if(-1<jQuery.inArray("Archived",e.articles[n].label_names))var a='<span style="display:inherit" class="archived-incident"><b>ARCHIVED</b></span>';else a="";var s=e.articles[n].id,l=new Date(e.articles[n].created_at);if("["===c[0]&&!e.articles[n].label_names.includes("Type:Maintenance"))var c=c.slice(c.indexOf("]")+1,c.length);var d="";$.each(e.articles[n].label_names,function(){-1<this.indexOf("Status")&&(d=this.replace("Status:","").toUpperCase())}),""==a&&(t++,$(".section > .article-list-"+o).append('<li style="display: list-item;padding: 10px 0"><a href="'+s+'">'+a+B(d)+c+"<br><small>Posted on "+l.toDateString()+" "+l.toLocaleTimeString()+'</small><span style="display: none">'+o+"</span></a></li>"),5==t&&5<e.count&&$(".section > .article-list-"+o).append('<div style="margin-top:10px"><a href="'+h[o]+'">View all incidents <span style="font-family:arial">→</span></a></div>')),0}}$(".section > .article-list").css("height","auto"),$(".main-components-container").css("margin-top","40px")})}}),L().done(function(e){D=e.user_segments})):$(".component-loader").remove(),-1<window.location.href.indexOf("/sections/")){var W=$(".section-description").text(),J=W.split("@",1),Y=(W.charAt(W.length-1),$(".section-subscribe .dropdown-toggle").text());if($(".page-header h1 span").html())var ee=$(".page-header h1 span").html();else ee="";$(".page-header h1").html(ee+J),"following"==Y.toLowerCase()?$(".section-subscribe .dropdown-toggle").html("Unfollow").css("background-color","#246fdc").css("color","#fff").css("border","1px solid #246fdc"):$(".section-subscribe .dropdown-toggle").html("+ Follow").css("color","#5c5c5c").css("border","solid 1px #979797"),$(".section-subscribe").append('<a class="create-maintenance-modal-btn add-article" rule="button" style="margin-top:1px">ADD MAINTENANCE</a><a class="create-incident-modal-btn add-article" rule="button" style="margin-top:1px">ADD INCIDENT</a>').removeClass("section-subscribe"),$(".article-list > li > a").each(function(){$(this).find("span").each(function(){$(this).hasClass("Hidden-title")||$(this).hasClass("Type:Template-title")||$(this).hasClass("Archived-title")&&("anonymous"==p||"end_user"==p)?$(this).parent().parent().remove():$(this).hasClass("Archived-title")&&"anonymous"!=p&&"end_user"!=p&&$(this).parent().prepend('<span style="display:inherit" class="archived-incident"><b>ARCHIVED</b></span>').css("margin-left","0 !important")})})}if($(".sub-nav .search").css("display","none"),$(".see-all-articles").each(function(){$(this).html('Past Incidents <span style="font-family:arial">→</span>')}),$("main").not(".messageBoard").append('<div class="incident-view-page"></div>'),-1!==jQuery.inArray("view_support_content",HelpCenter.user.tags)){function te(t){D.length?t():L().done(function(e){D=e.user_segments,t()})}function ne(){$("#mInternal .gswitch input").prop("checked")||$("#mExternal .gswitch input").prop("checked")?$("#create-new-scheduled-maintenance").prop("disabled",!1):$("#create-new-scheduled-maintenance").prop("disabled",!0),$("#iInternal .gswitch input").prop("checked")||$("#iExternal .gswitch input").prop("checked")?$("#create-incident-btn").prop("disabled",!1):$("#create-incident-btn").prop("disabled",!0)}$("body").append('<div class="message-board-container"><header class="header"><div class="header-inner clearfix"><div id="goto-status" class="close-MB-admin"><i class="fa fa-times"></i></div><div class="logo"><h2>Message Board Admin</h2></div><nav class="user-nav"><a role="button" id="goto-incidents">Incidents</a><a role="button" id="goto-subscribers">Subscribers</a><a role="button" id="goto-platforms">Platforms</a></nav></div></header></nav><main class="messageBoard"></main>').append('<button id="goto-messageBoard-admin"><svg class="message-board-admin-icon" viewBox="2 2 22 22"><path fill="currentColor" d="M13 16.627a3.625 3.625 0 0 1-3.63-3.622A3.633 3.633 0 0 1 13 9.373a3.633 3.633 0 0 1 3.63 3.632A3.625 3.625 0 0 1 13 16.627m8.295-4.902h-.006a2.116 2.116 0 0 1-1.955-1.307l-.031-.075a2.117 2.117 0 0 1 .459-2.306.693.693 0 0 0 0-.998l-.809-.809a.71.71 0 0 0-.997 0 2.106 2.106 0 0 1-2.295.457l-.08-.033a2.109 2.109 0 0 1-1.302-1.948.705.705 0 0 0-.705-.706h-1.148a.705.705 0 0 0-.705.706c0 .855-.514 1.628-1.306 1.95-.021.009-.043.017-.063.027a2.106 2.106 0 0 1-2.308-.453.72.72 0 0 0-1.006 0l-.81.81a.708.708 0 0 0 0 .997l.007.006a2.11 2.11 0 0 1 .454 2.305c-.01.022-.018.045-.028.066a2.103 2.103 0 0 1-1.95 1.311h-.006a.706.706 0 0 0-.705.706v1.138c0 .39.316.706.705.706h.002a2.1 2.1 0 0 1 1.949 1.306l.029.069a2.11 2.11 0 0 1-.452 2.31l-.004.003a.708.708 0 0 0 0 .998l.809.809a.72.72 0 0 0 1.006 0l.005-.005a2.106 2.106 0 0 1 2.307-.452l.059.024a2.104 2.104 0 0 1 1.306 1.95v.007c0 .395.32.706.705.706h1.148c.385 0 .705-.31.705-.706v-.007c0-.855.514-1.627 1.306-1.95l.059-.024a2.106 2.106 0 0 1 2.307.452l.005.005a.71.71 0 0 0 .997 0l.809-.81a.693.693 0 0 0 0-.997l-.004-.003a2.11 2.11 0 0 1-.452-2.31l.029-.069a2.102 2.102 0 0 1 1.948-1.306h.012a.706.706 0 0 0 .705-.706v-1.138a.706.706 0 0 0-.705-.706"></path></svg>Message Board Admin</button>'),$("main.messageBoard").append('<div class="incident-container"> <div class="incident-navigation"> <div class="incident-nav-header"> <div class="incident-header-title">Incidents</div><a class="create-incident-modal-btn incident-subscribe-button incident-save-button">+ NEW INCIDENT</a><a class="create-maintenance-modal-btn incident-subscribe-button incident-save-button">+ NEW MAINTENANCE</a><a id="new-incident-template" class="incident-subscribe-button incident-save-button">+ INCIDENT TEMPLATE</a><a id="new-maintenance-template" class="incident-subscribe-button incident-save-button">+ Maintenance TEMPLATE</a><input class="incident-nav-search" type="search" placeholder="Search"> </div> <div class="incident-nav-cont"> </div>  </div></div><div class="platform-container"> <div class="incident-navigation"><div class="incident-nav-header"> <div class="incident-header-title">Platforms </div> </div> <div class="incident-nav-board"> <a id="create-platform-btn" class="incident-subscribe-button incident-save-button">+ NEW PLATFORM </a></div><div class="incident-list-item" style="border-bottom:2px solid #E0E0E0;width:100%;margin-top: -40px;"><div class="incident-item-body"><h5></h5></div> <div class="incident-item-action" style="flex:3"><h5 style="width:220px"></h5><h5 style="width:220px"></h5><h5 style="flex:1;text-align:center">Show Status</h5><h5 style="flex:1;text-align:center">Show Section</h5><h5 style="flex:1;"></h5></div></div></div> <div class="platform-list-cont"></div></div><div class="subs-container"> <div class="subs-navigation"> <div class="subs-nav-header"> <div class="subs-header-title">Subscribers </div> <input class="subs-nav-search" type="search" placeholder="Search"> </div> <div class="subs-nav-cont"> </div> <div class="subs-nav-board"> <input type="email" placeholder="User email" spellcheck="false" id="subs-add-email"> <a id="subs-item-add" class="incident-subscribe-button incident-save-button">Add Subscriber </a></div> </div></div><div class="incident-view-page"></div>'),$("body").append('<div class="modal" id="new-scheduled-maintenance-modal"> <div class="modal-content"> <div class="modal-header"><button class="close close-modal">X</button><h1>New Scheduled Maintenance</h1><div class="select-template"><select class="select-picker select-template-dropdown" name="Select Template"><option value="none">Use Template</option></select></div></div><div class="modal-body"> <div class="modal-body-detail components-affected"> <label>Components Affected</label> <div class="component-container"> </div></div> <h1 style="font-size: 20px;font-weight: 400;">Messaging</h1><br><div class="modal-body-detail maintenance-name"> <label>Title</label><input id="maintenance-name" name="" placeholder="Maintenance Title" type="text" required> </div><div class="modal-body-detail maintenance-details"> <div style="padding: 20px;border: 1px solid #ababab;border-radius: 5px;background-color: #fffdf6;" id="mInternal"><label class="gswitch"><input type="checkbox" id="mInternalMessage"><span class="gslider round"></span></label><label style="margin-bottom: 30px;font-size:18px">Internal Message</label> <div class="maintenance-container" style="clear: both; display: block;margin-bottom:30px">Send e-mail to subscribers<label class="gswitch"><input type="checkbox" id="mEmailSubscribers"><span class="gslider round green"></span></label></div> <textarea placeholder="Message" id="mMessage"></textarea> </div><br><div style="padding: 20px;border: 1px solid #ababab;border-radius: 5px;background-color: #F5FDFE;" id="mExternal"><label class="gswitch"><input type="checkbox" id="mExternalMessage"><span class="gslider round"></span></label><label style="margin-bottom: 30px;font-size:18px">External Message <span style="font-size: 0.7em;vertical-align: middle;font-weight: 400;">| <span class="copyText" style="color:#2E64F8;">Copy from Internal Message</span></span></label> <div style="clear: both; display: none" id="showHome">Show in SAS homepage<label class="gswitch"><input type="checkbox" id="mExShowHomepage"><span class="gslider round green"></span></label></div> <div  style="clear: both; display: block; margin-bottom:30px">Send e-mail to subscribers<label class="gswitch"><input type="checkbox" id="mExEmailSubscribers"><span class="gslider round green"></span></label></div> <textarea placeholder="Message" id="mExMessage"></textarea> </div> </div><div class="maintenance-start"> <label>Maintenance Start Time</label> <div class="maintenance-time"> <input name="" type="date" required> <select class="time-select"></select> </div><span class="info">All times must be specified in EST - Eastern Standard Time(US & Canada)</span> </div><div class="maintenance-end"> <label>Maintenance End Time</label> <div class="maintenance-time"> <input name="" type="date" required> <select class="time-select"></select> </div><span class="info">All times must be specified in EST - Eastern Standard Time(US & Canada)</span> </div></div><div class="modal-footer"><button class="btn btn-primary" id="create-new-scheduled-maintenance">CREATE MAINTENANCE</button></div></div></div>'),$("body").append('<div class="modal" id="create-incident-modal"> <div class="modal-content"> <div class="modal-header"><button class="close close-modal">X</button><h1>Create an Incident</h1><div class="select-template"><select class="select-picker select-template-dropdown" name="Select Template"> <option class="template" value="none">Use Template</option> </select> </div></div><div class="modal-body"> <div class="modal-body-detail components-affected"> <label>Components Affected</label> <div class="component-container"> </div></div><h1 style="font-size: 20px;font-weight: 400;">Messaging</h1><br><div class="modal-body-detail incident-name"> <label>Title</label> <br><input type="text" id="incident-name" name="" placeholder="Incident Title"><span class="info"></span> </div><div class="modal-body-detail incident-severity"><label>Severity</label><br><select><option value="1">Operational</option><option value="3">Degraded Performance</option><option value="4">Minor Outage</option><option value="5">Major Outage</option></select></div><div class="modal-body-detail incident-status"> <label>Status</label> <div class="status-choices"> <input type="radio" name="iInvestigating" value="Investigating"><span class="radio-label">Investigating</span> <input type="radio" name="iIdentified" value="Identified"><span class="radio-label">Identified</span> <input type="radio" name="iMonitoring" value="Monitoring"><span class="radio-label">Monitoring</span> <input type="radio" name="iResolved" value="Resolved"><span class="radio-label">Resolved</span> </div></div><div class="modal-body-detail incident-message"> <div style="padding: 20px;border: 1px solid #ababab;border-radius: 5px;background-color: #fffdf6;" id="iInternal"><label class="gswitch"><input type="checkbox" id="iInternalMessage"><span class="gslider round"></span></label><label style="margin-bottom: 30px;font-size:18px">Internal Message</label> <div class="send-notification-label" style="clear: both; display: block;margin-bottom:30px">Send e-mail to subscribers<label class="gswitch"><input type="checkbox" id="iEmailSubscribers"><span class="gslider round green"></span></label></div> <textarea placeholder="Message" id="iMessage"></textarea> </div><br><div style="padding: 20px;border: 1px solid #ababab;border-radius: 5px;background-color: #F5FDFE;" id="iExternal"><label class="gswitch"><input type="checkbox" id="iExternalMessage"><span class="gslider round"></span></label><label style="margin-bottom: 30px;font-size:18px">External Message <span style="font-size: 0.7em;vertical-align: middle;font-weight: 400;">| <span class="copyText" style="color:#2E64F8;">Copy from Internal Message</span></span></label> <div style="clear: both; display: none" id="showHome">Show in SAS homepage<label class="gswitch"><input type="checkbox" id="iExShowHomepage"><span class="gslider round green"></span></label></div> <div  style="clear: both; display: block; margin-bottom:30px">Send e-mail to subscribers<label class="gswitch"><input type="checkbox" id="iExEmailSubscribers"><span class="gslider round green"></span></label></div> <textarea placeholder="Message" id="iExMessage"></textarea> </div></div></div><div class="modal-footer"><button class="btn btn-primary" id="create-incident-btn">CREATE INCIDENT</button></div></div></div>'),$("body").append('<div class="modal" id="new-incident-template-modal"> <div class="modal-content"> <div class="modal-header"><button class="close close-modal">X</button><h1>Incident Template</h1><div class="select-template"><select class="select-picker update-template-dropdown" name="Select Template"><option class="template" value="none">Update Template</option> </select> </div></div> <div class="modal-body"> <div class="modal-body-detail template-name"><label>Template Name</label><br><input type="text" placeholder="Template Name"><span class="info">This is used internally so you can identify which template you are using.</span></div><div class="modal-body-detail incident-title"> <label>Incident Title </label> <br> <input type="text" placeholder="Incident Title"><span class="info">The title given to the incident or scheduled maintenance. This is only applied when creating an incident or scheduled maintenance.</span></div><div class="modal-body-detail incident-status"> <label>Incident Status</label><br><select> <option value="Investigating">Investigating</option> <option value="Identified">Identified</option> <option value="Monitoring">Monitoring</option> <option value="Resolved">Resolved</option> </select><span class="info">The status will be applied to the incident or scheduled maintenance.</span></div><div class="modal-body-detail incident-severity"><label>Incident Severity</label><br><select><option value="1">Operational</option><option value="3">Degraded Performance</option><option value="4">Minor Outage</option><option value="5">Major Outage</option></select><span class="info">The severity will be applied to the incident or scheduled maintenance.</span></div><div class="modal-body-detail incident-message"> <label>Message Body </label> <br> <textarea placeholder="Message" style="margin-top: 0px; margin-bottom: 0px; height: 80px;"> </textarea> </div> <div class="modal-body-detail components-affected"> <label>Alert Users Subscribed To: </label> <div class="component-container"></div> </div></div><div class="modal-footer"><button class="btn btn-primary delete-template-btn">DELETE TEMPLATE</button><button class="btn btn-primary" id="update-incident-template-btn">UPDATE TEMPLATE</button><button class="btn btn-primary" id="create-incident-template-btn">CREATE INCIDENT TEMPLATE</button></div> </div></div>'),$("body").append('<div class="modal" id="new-maintenance-template-modal"> <div class="modal-content"> <div class="modal-header"> <button class="close close-modal">X </button> <h1>Maintenance Template</h1><div class="select-template"><select class="select-picker update-template-dropdown" name="Select Template"> <option class="template" value="none">Update Template</option> </select> </div></div> <div class="modal-body"> <div class="modal-body-detail template-name"> <label>Template Name </label> <br> <input type="text" placeholder="Template Name"> <span class="info">This is used internally so you can identify which template you are using. </span> </div> <div class="modal-body-detail maintenance-title"> <label>Maintenance Title </label> <br> <input type="text" placeholder="Maintenance Title"> <span class="info">The title given to the incident or scheduled maintenance. This is only applied when creating an incident or scheduled maintenance. </span> </div> <div class="modal-body-detail maintenance-body"> <label>Message Body </label> <br> <textarea placeholder="Message" style="margin-top: 0px; margin-bottom: 0px; height: 80px;"> </textarea> </div> <div class="modal-body-detail components-affected"> <label>Alert Users Subscribed To: </label> <div class="component-container"> </div> </div> </div> <div class="modal-footer"><button class="btn btn-primary delete-template-btn">DELETE TEMPLATE</button><button class="btn btn-primary" id="update-maintenance-template-btn">UPDATE TEMPLATE</button><button class="btn btn-primary" id="create-maintenance-template-btn">CREATE MAINTENANCE TEMPLATE </button> </div> </div></div>'),$(".message-board-container").append('<div class="hide" id="loader-container"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div><div class="warningMessage"><div class="warning-sign-container"><a><i class="fa fa-exclamation-circle"></i></a></div><div class="warning-message-container"><span>Making API Requests</span><br><span>Please do not press back button or close window.</span></div></div></div>'),$("body").append('<div class="modal" id="new-incident-modal"> <div class="modal-content"> <div class="modal-header"> <button class="close close-modal">X</button> <h1>Related Incident</h1> <div class="select-template"> <select class="select-picker select-template-dropdown" name="Select Template"> <option class="template" value="none">Use Template</option> </select> </div></div><div class="modal-body"> <div class="modal-body-detail components-affected"> <label>Components Affected</label> <div class="component-container"> </div></div><h1 style="font-size: 20px;font-weight: 400;">Messaging</h1> <br><div class="modal-body-detail incident-name"> <label>Title</label> <br><input type="text" id="incident-name" name="" placeholder="Incident Title"><span class="info"></span> </div><div class="modal-body-detail incident-severity"> <label>Severity</label><br><select> <option value="1">Operational</option> <option value="3">Degraded Performance</option> <option value="4">Minor Outage</option> <option value="5">Major Outage</option> </select> </div><div class="modal-body-detail incident-status"> <label>Status</label> <div class="status-choices"> <input type="radio" name="iInvestigating" value="Investigating"><span class="radio-label">Investigating</span> <input type="radio" name="iIdentified" value="Identified"><span class="radio-label">Identified</span> <input type="radio" name="iMonitoring" value="Monitoring"><span class="radio-label">Monitoring</span> <input type="radio" name="iResolved" value="Resolved"><span class="radio-label">Resolved</span> </div></div><div class="modal-body-detail incident-message"> <div style="padding: 20px;border: 1px solid #ababab;border-radius: 5px;background-color: #F5FDFE;" id="iExternal"><label style="margin-bottom: 30px;font-size:18px">External Message</label> <div id="showHome">Show in SAS homepage<label class="gswitch"><input type="checkbox" id="iExShowHomepage" checked><span class="gslider round green"></span></label></div><div style="margin-bottom:30px">Send e-mail to subscribers<label class="gswitch"><input type="checkbox" id="iExEmailSubscribers" checked><span class="gslider round green"></span></label></div><textarea placeholder="Message" id="new-external-message" style="display:none;"></textarea> </div></div></div><div class="modal-footer"><button class="btn btn-primary" id="create-new-incident-btn">CREATE INCIDENT</button></div></div></div>'),$("textarea").not($("#new-incident-modal").find("textarea")).ckeditor(),$(".create-maintenance-modal-btn").click(function(){te(function(){if(le(),$("html").css("overflow","hidden"),!$("#new-scheduled-maintenance-modal .segments-select").length){var e='<div class="segments-container"><label for="segments-select">Visible To</label>'+z()+" </div>";$(e).insertBefore("#mInternal .maintenance-container"),$(e).insertAfter("#mExternal #showHome")}$("#new-scheduled-maintenance-modal").fadeIn("fast"),$("#mInternal .segments-select").val(gSZMKAgentManagerSegmentID),$("#mExternal .segments-select").val(gSZMKSignedInSegmentID),setTimeout(function(){CKEDITOR.instances.mMessage.plugins.lite.findPlugin(CKEDITOR.instances.mMessage).toggleTracking(!1,!1),CKEDITOR.instances.mExMessage.plugins.lite.findPlugin(CKEDITOR.instances.mExMessage).toggleTracking(!1,!1)},300),$(".gswitch input").prop("checked",!0),$("#mExShowHomepage").prop("checked",!1),$("#mInternal > div").fadeIn(),$("#mExternal > div").fadeIn(),$("#mExternal > #showHome").hide()})}),$(".create-incident-modal-btn").click(function(){te(function(){if(le(),$("html").css("overflow","hidden"),!$("#create-incident-modal .segments-select").length){var e='<div class="segments-container"><label for="segments-select">Visible To</label>'+z()+" </div>";$(e).insertBefore("#iInternal .send-notification-label"),$(e).insertAfter("#create-incident-modal #showHome")}$("#create-incident-modal").fadeIn("fast"),$("#iInternal .segments-select").val(gSZMKAgentManagerSegmentID),$("#iExternal .segments-select").val(gSZMKSignedInSegmentID),setTimeout(function(){CKEDITOR.instances.iMessage.plugins.lite.findPlugin(CKEDITOR.instances.iMessage).toggleTracking(!1,!1),CKEDITOR.instances.iExMessage.plugins.lite.findPlugin(CKEDITOR.instances.iExMessage).toggleTracking(!1,!1)},300),$(".gswitch input").prop("checked",!0),$("#iExShowHomepage").prop("checked",!1),$("#iInternal > div").fadeIn(),$("#iExternal > div").fadeIn(),$("#showHome").hide()})}),$("#iInternalMessage").click(function(){$("#iInternal .gswitch input").prop("checked")?($("#iSubscribeGN, #iEmailSubscribers").prop("checked",!0),$("#iInternal > div").fadeIn()):($("#iSubscribeGN, #iEmailSubscribers").prop("checked",!1),$("#iInternal > div").fadeOut()),ne()}),$("#iExternalMessage").click(function(){$("#iExternal .gswitch input").prop("checked")?($("#iExSubscribeGN, #iExEmailSubscribers").prop("checked",!0),$("#iExternal > div").fadeIn()):($("#iExSubscribeGN, #iExEmailSubscribers").prop("checked",!1),$("#iExternal > div").fadeOut()),ne()}),$("#mInternalMessage").click(function(){$("#mInternal .gswitch input").prop("checked")?($("#mSubscribeGN, #mEmailSubscribers").prop("checked",!0),$("#mInternal > div").fadeIn()):($("#mSubscribeGN, #mEmailSubscribers").prop("checked",!1),$("#mInternal > div").fadeOut()),ne()}),$("#mExternalMessage").click(function(){$("#mExternal .gswitch input").prop("checked")?($("#mExSubscribeGN, #mExEmailSubscribers").prop("checked",!0),$("#mExternal > div").fadeIn()):($("#mExSubscribeGN, #mExEmailSubscribers").prop("checked",!1),$("#mExternal > div").fadeOut()),ne()}),$('.incident-status input[type="radio"]').change(function(){$('.incident-status input[type="radio"]').each(function(){$(this).prop("checked",!1)}),$(this).prop("checked",!0)}),$(".close-modal").click(function(){if($(this).closest(".modal").fadeOut("fast"),$(".modal-footer #related-incidents-container").remove(),$(".incident-container").is(":visible"))return!1;$("html").css("overflow","auto")});var ie=[];function ae(){$.get("/api/v2/help_center/en-us/articles.json?label_names=Type:Template",function(e){for($(".select-template-dropdown").each(function(){$(this).find("option:not(:first)").remove()}),$(".update-template-dropdown").each(function(){$(this).find("option:not(:first)").remove()}),$(".select-template-dropdown,.update-template-dropdown").addClass("select-picker"),ie=[],x=0;x<e.count;x++){var t=e.articles[x].title,n=e.articles[x].label_names[1];if(1==t.includes("[Template]"))t=t.replace("[Template]","");var i=e.articles[x].id;if("For:Incident"==n){var a="<option value='"+i+"'>"+t+"</option>";$("#create-incident-modal .select-template-dropdown, #new-incident-template-modal .update-template-dropdown").append(a)}else{a="<option value='"+i+"'>"+t+"</option>";$("#new-scheduled-maintenance-modal .select-template-dropdown, #new-maintenance-template-modal .update-template-dropdown").append(a)}var s=e.articles[x].body.split("::::"),l=s[4].split(",");for(template=[],template.template_name=t,template.incident_name=s[0],template.incident_status=s[1],template.incident_severity=s[2],template.incident_message=s[3],template.incident_componentsAffected=[],y=0;y<l.length;y++)""!=l[y]&&template.incident_componentsAffected.push(l[y]);template.id=i,ie[i]=template}xe()})}function se(){$("select.time-select").each(function(){if(""==$(this).text())for(x=1;x<=24;x++){var e=x;x<10&&(e="0"+x);var t="<option>"+e+":00</option>";$(this).append(t)}})}function le(){$(".modal").find("input[type='checkbox']").attr("checked",!1).trigger("change"),$(".modal").find("input[type='radio']").attr("checked",!1),$(".modal").find("input[type='text']").val(""),$(".modal").find("textarea").val(""),$(".delete-template-btn,#update-incident-template-btn,#update-maintenance-template-btn").hide(),$("#create-maintenance-template-btn,#create-incident-template-btn").show()}function ce(e,t,n){var i,a={},s={};if("incident"===n)s.title="["+t.incidentStatus+"] "+t.incidentName,s.body=t.incidentStatus+":<br><br>"+t.message,a.article=s,a.article.label_names=function(e,t){var n=["Type:Incident","Status:"+e.incidentStatus,"Name:"+e.incidentName,"Severity:"+e.incidentSeverity];0==e.sas_visibility&&t==w&&n.push("Hidden");1==e.sas_visibility&&t==w&&n.push("ShowInHomepage");e.platformIDs&&n.push(e.platformIDs);return n}(t,e);else{var l="Maintenance Start: "+t.startTime.date+" "+t.startTime.time+" ",c="Maintenance End: "+t.endTime.date+" "+t.endTime.time+" ";s.title=t.maintenanceName+" "+t.startTime.date,s.body="New:<br><br><strong>"+l+"</strong><br><strong>"+c+"</strong><br><br>"+t.maintenanceDetails,a.article=s,a.article.label_names=function(e,t){var n=["Type:Maintenance","Status:New","Name:"+e.maintenanceName];0==e.sas_visibility&&t==w?n.push("Hidden"):1==e.sas_visibility&&t==w&&n.push("ShowInHomepage");return n}(t,e)}a.article.author_id=o,a.article.user_segment_id=t.user_segment_id,a.notify_subscribers=t.notifications,C.push(U(e)),C.push((i=a,{url:"/api/v2/help_center/sections/"+e+"/articles.json",type:"POST",data:JSON.stringify(i),contentType:"application/json",action:"createIncident"}))}function de(){$("#back-incident-list").click(),$(".message-board-container").css("left","100%"),$("html").css("overflow","auto"),$(".messageBoard > div").fadeOut("slow"),$(".modal-backdrop").remove(),$(".wrapper").css("filter","none"),$(".incident-nav-item").removeClass("incident-nav-item-active"),r&&location.reload()}function oe(){$("#internal-message-switch").is(":checked")?($("#update-internal-message #send-comment-notif,#update-internal-message  .subscribe-global-notif").prop("checked",!0),$("#update-internal-message > div").fadeIn()):($("#update-internal-message #send-comment-notif,#update-internal-message  .subscribe-global-notif").prop("checked",!1),$("#update-internal-message > div").fadeOut())}function re(){$("#external-message-switch").is(":checked")?($("#update-external-message #send-comment-notif,#update-external-message  .subscribe-global-notif").prop("checked",!0),$("#update-external-message > div").fadeIn()):($("#update-external-message #send-comment-notif,#update-external-message  .subscribe-global-notif").prop("checked",!1),$("#update-external-message > div").fadeOut())}function pe(e){if(e)for(var t=0,n=D.length;t<n;t++)if(D[t].id==e)return D[t].name;return"Everyone"}function me(g,e){!function(e,t){t++;var n=$("#incident-"+e+" .incident-list .pagination").children("li").get(t);$(n).children("a").text("").css("padding","0px 7px"),$(n).children("a").append('<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')}(g,e);var t,n,y=$("#incident-"+g+" .incident-list").children(),x=(t=g)==messageBoardSAS?s:t==messageBoardMDX?l:t==messageBoardDSP?c:t==messageBoardDMP?T:t==messageBoardSiteOP?_:t==messageBoardInternal?M:0;function i(){$.get("/api/v2/help_center/en-us/sections/"+g+"/articles.json?per_page=20&page="+e).done(function(e){for(var t="",n=0,i=e.articles.length;n<i;n++){for(var a=e.articles[n].label_names,s="",l="Archive",c="activate",d="",o="",r="",p=e.articles[n].user_segment_id,m=0;m<a.length;m++)a[m].includes("Type:")&&(s=a[m].replace("Type:","")),"Archived"==a[m]&&(l="Unarchive",c="activated"),"Hidden"==a[m]?(d="Show",o="activate"):"ShowInHomepage"==a[m]&&(d="Hide",o="activated"),a[m].includes("Status:")&&(r=a[m].replace("Status:","").toUpperCase());if("Template"!=s&&""!=s){var u=e.articles[n].id,v=e.articles[n].title,b=(e.articles[n].html_url,e.articles[n].created_at),h=new Date(b);if("["===v[0]&&"Maintenance"!=s&&(v=v.slice(v.indexOf("]")+1,v.length)),""!=d)d='</a><a class="incident-item-hide '+o+'">'+d+"</a>";var f="";g!=w&&(f='<a class="incident-item-archive '+c+'">'+l+"</a>"),t+='<div class="incident-list-item"><div class="incident-item-body"><h5>'+B(r)+v+"</h5><small>Posted on "+h.toDateString()+" "+h.toLocaleTimeString()+'</small><span class="label user-segments-label">'+pe(p)+'</span></div><div class="incident-item-action"><a class="incident-item-view">View '+s+"</a>"+d+f+'<a class="incident-subscribe-button" id="incident-item-delete">Delete</a><a class="incident-subscribe-button" id="update-'+s.toLowerCase()+'-btn">Update<span class="hide">'+u+'</span><span id="platform_id" style="display:none;">'+g+"</span></a></div></div>"}}$("#incident-"+g+" .incident-list").append(t),F(),1<x&&function(e,t,n){var i="",a="";1==t&&(i="disabled"),t==n&&(a="disabled");var s='<div><ul class="pagination" style="width:'+(o=n,10<=o?55:3.8*(o+4))+'% !important;"><li class="page-item '+i+' relative first-button"><a class="page-link" aria-label="First"><span aria-hidden="true">&laquo;</span></a></li><li class="page-item '+i+' relative previous-button"><a class="page-link" aria-label="Previous"><span aria-hidden="true">‹</span></a></li>',l=1,c=10,d=n-t;var o;10<n&&6<t&&(l=t-5,c=t+4),d<4&&(c=n,l-=4-d);for(var r=1;r<=n;r++){var p="",m="";(r<l||c<r)&&(p="hide"),r==t&&(m="active"),s+='<li class="page-item '+m+p+'" ><a>'+r+"</a></li>"}s+='<li class="page-item relative '+a+' next-button"><a class="page-link" aria-label="Next"><span aria-hidden="true">›</span></a></li><li class="page-item relative '+a+' last-button"><a class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;</span></a></li></ul></div>',$("#incident-"+e+" .incident-list").append(s),$("#incident-"+e+" .incident-list .pagination").children("li").not(".active, .disabled, .relative").on("click",function(){me(e,$(this).children("a").text())}),i||($("#incident-"+e+" .incident-list .pagination .first-button").on("click",function(){me(e,1)}),$("#incident-"+e+" .incident-list .pagination .previous-button").on("click",function(){me(e,t-1)})),a||($("#incident-"+e+" .incident-list .pagination .next-button").on("click",function(){me(e,t+1)}),$("#incident-"+e+" .incident-list .pagination .last-button").on("click",function(){me(e,n)}))}(g,e.page,x),y.remove(),$(".message-board-container").scrollTo(0,0)})}x?i():(H(),(n=g,$.get("/api/v2/help_center/articles/search.json?label_names=Type:Incident,Type:Maintenance&section="+n+"&per_page=20&page=1")).done(function(e){var t,n;x=e.page_count,t=g,n=e.page_count,t==messageBoardSAS&&(s=n),t==messageBoardMDX&&(l=n),t==messageBoardDSP&&(c=n),t==messageBoardDMP&&(T=n),t==messageBoardSiteOP&&(_=n),t==messageBoardInternal&&(M=n),i()}))}function ue(e){$(".platform-list-cont").html(""),$.get("/api/v2/help_center/categories/"+e+"/sections.json",function(e){for(var t=1,n=0;n<e.count;n++){for(var i=name=temp="",a=e.sections[n].description,s=a.split("@"),l=0;l<s.length;l++)-1<s[l].indexOf("status")?i=s[l].replace(/\s/g,"").replace("status:",""):-1<s[l].indexOf("mdxnxt")||-1<s[l].indexOf("mdx2")||-1<s[l].indexOf("supportkb")||-1<s[l].indexOf("strikead")?temp=temp+"@"+s[l]:-1==s[l].indexOf("component")&&-1==s[l].indexOf("show_content")?name=s[l]:name=s[0];if(-1<a.indexOf("@component"))var c="Disable",d="activated";else c="Enable",d="activate";if(-1<a.indexOf("@show_content"))var o="Hide Content",r="activated";else o="Show Content",r="activate";var p=e.sections[n].id,m=e.sections[n].user_segment_id;$(".platform-list-cont").append('<div class="incident-list-item"> <div class="incident-item-body"><h5>'+name+'</h5><span class="hide">'+temp+'</span></div> <div class="incident-item-action"><select class="select-picker plat-status" title="Platform Status"><option value="1">Operational</option><option value="2">Under Maintenance</option><option value="3">Degraded Performance</option><option value="4">Partial Outage</option><option value="5">Major Outage</option></select><select class="select-picker plat-segment" title="User Segment"><option value="">Visible to everyone </option><option value="526223">Signed-in users </option><option value="526203">Agents and managers </option></select><a title="'+c+' Platform" class="platform-item-open '+d+'">'+c+'</a><a title="'+o+'" class="platform-open-content '+r+'">'+o+"</a><span>"+p+"</span> </div></div>")&&($(".platform-list-cont .incident-list-item:nth-child("+t+") select.plat-segment").val(m),$(".platform-list-cont .incident-list-item:nth-child("+t+") select.plat-status").val(i)),t++}$(".plat-status:visible").each(function(){$(this).hide().addClass("k-selected").removeClass("select-picker");var i=$(this).val();$(this).before('<div class="k-select" tabindex="-1"><span></span><ul></ul></div>'),$(this).find("option").each(function(e){var t=$(this).html(),n=$(this).val();i==n?($(this).parent().prev(".k-select").find("span").first().html('<i class="fa fa-circle" style="color:'+E[e]+'"></i>'+t),$(this).parent().prev(".k-select").find("ul").append('<li style="display:none"><i class="fa fa-circle" style="color:'+E[e]+'"></i>'+t+"<span>"+n+"</span></li>")):$(this).parent().prev(".k-select").find("ul").append('<li><i class="fa fa-circle" style="color:'+E[e]+'"></i>'+t+"<span>"+n+"</span></li>")})}),xe()})}function ve(e){""!=e&&(0==$("#add-subscriber-report").length?($(".message-board-container").append('<div class="modal" id="add-subscriber-report"><div class="modal-content" style="max-width:500px"><div class="modal-header"><button class="close close-modal">X</button><h1 style="font-size:17px">Invalid User Email</h1></div><div class="modal-body"><div class="modal-body-detail">'+e+'</div></div><div class="modal-footer"></div></div></div>'),$("#add-subscriber-report").fadeIn("fast")):($("#add-subscriber-report .modal-body-detail").append(", "+e),$("#add-subscriber-report .modal-header h1").html("Invalid User Emails")))}function be(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{2,3}\.[0-9]{1,3}\.[0-9]{2,3}\.[0-9]{2,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,3}))$/.test(e)}function he(e,t,n,i){$.get("/api/v2/users/show_many.json?ids="+e,function(e){e=e.users[0].email;$("#subs-"+i+" .subs-lists").append('<div class="subs-lists-item"><input type="checkbox" value="'+t+'"><div>'+e+"</div><div>"+n.toDateString()+" "+n.toLocaleTimeString()+'</div><div><a class="subs-item-delete">Remove</a><span>'+t+"</span></div></div>")})}function fe(l){$.get("/api/v2/help_center/en-us/sections/"+l+"/subscriptions.json",function(e){for(var t=e.subscriptions.length,n=(new Date).getMonth(),i=0,a=0;a<t;a++){var s=e.subscriptions[a].created_at;n==new Date(s).getMonth()&&i++}$("#subs-"+l+" .subs-list-desc").html("Total "+t+" email subscribers, "+i+" added this month.")})}function ge(t,n){$(".subs-lists-item:visible input:checkbox:checked").each(function(){var e=$(this).closest("div").find("span").text();e!=n&&($.ajax({url:"/api/v2/help_center/sections/"+t+"/subscriptions/"+e+".json",type:"DELETE"}),$(this).closest(".subs-lists-item").remove())}),setTimeout(function(){fe(t),$("#subs-"+t+" .checked-email-subscribers").remove()},1e3)}ae(),$(".select-template-dropdown").change(function(){if("none"!=$(this).val()){var e=$(this).val();for($(".incident-message textarea, .maintenance-details textarea").val(ie[e].incident_message),$("#incident-name, #maintenance-name").val(ie[e].incident_name),x=0;x<ie[e].incident_componentsAffected.length;x++)$(this).parent().parent().parent().find("input[value='"+ie[e].incident_componentsAffected[x]+"']").click();$(".incident-severity select").val(ie[e].incident_severity);var t="i"+ie[e].incident_status;$("input[name='"+t+"']").prop("checked",!0)}else le(),$(".gswitch input").prop("checked",!0),$("#iExShowHomepage").prop("checked",!1)}),$(".update-template-dropdown").change(function(){if("none"!=$(this).val()){$(".delete-template-btn,#update-incident-template-btn,#update-maintenance-template-btn").show(),$("#create-maintenance-template-btn,#create-incident-template-btn").hide();var e=$(this).val();for($(".template-name input[type='text']").val(ie[e].template_name),$(".incident-message textarea, .maintenance-message textarea").val(ie[e].incident_message),$(".incident-title input[type='text'], .maintenance-title input[type='text']").val(ie[e].incident_name),$("#new-incident-template-modal .incident-status select").val(ie[e].incident_status),$(".incident-severity select").val(ie[e].incident_severity),x=0;x<ie[e].incident_componentsAffected.length;x++)$("input[value='"+ie[e].incident_componentsAffected[x]+"']").prop("checked",!0);var t="i"+ie[e].incident_status;$("input[name='"+t+"']").prop("checked",!0)}else le()}),se(),function(){var e=new Date,t=e.getMonth()+1,n=e.getDate(),i=e.getFullYear();t<10&&(t="0"+t.toString());n<10&&(n="0"+n.toString());var a=i+"-"+t+"-"+n;$("input[type='date']").attr("min",a),$("input[type='date']").val(a)}(),$("body").on("change","#create-incident-modal .component input[value='"+w+"'], #new-scheduled-maintenance-modal .component input[value='"+w+"']",function(){if("create-incident-modal"==$(this).closest(".modal").attr("id"))var e="Incident";else e="Maintenance";$(this).is(":checked")?"Incident"==e?($("#showHome").show(),$("#iExShowHomepage").prop("checked",!0)):($("#showHome").show(),$("#mExShowHomepage").prop("checked",!0)):"Incident"==e?($("#showHome").hide(),$("#iExShowHomepage").prop("checked",!1)):($("#showHome").hide(),$("#mExShowHomepage").prop("checked",!1))}),$(".copyText").click(function(){$("#iExMessage").val($("#iMessage").val()),$("#mExMessage").val($("#mMessage").val())}),$("#create-incident-btn").click(function(){console.log("%c Create Incident ","background:#006dcc; color:#ffffff;font-size:15px;"),$(this).attr("disabled",!0);var e=$(this).closest(".modal"),t=[];if(t.incidentName=e.find("#incident-name").val(),t.incidentStatus=e.find('.incident-status input[type="radio"]:checked').val(),t.incidentSeverity=e.find(".incident-severity select").val(),""==t.incidentName||null==t.incidentStatus||null==e.find('.components-affected input[type="checkbox"]:checked').val())$(this).removeAttr("disabled"),alert("Please fill up all the fields.");else if($("#iInternal .gswitch input").prop("checked")&&""==$("#iInternal textarea").val()||$("#iExternal .gswitch input").prop("checked")&&""==$("#iExternal textarea").val())$(this).removeAttr("disabled"),alert("Internal or External message is enabled but empty.\nPlease disable it or add the message.");else{if($("#iInternal .gswitch input").prop("checked")){var n="";if(e.find('.components-affected input[type="checkbox"]:checked').siblings("span").each(function(){n=n+"["+$(this).text().trim()+"]"}),n=n+" "+e.find("#incident-name").val(),t.incidentName=n,t.message=$("#iInternal textarea").val(),t.notifications=$("#iEmailSubscribers").prop("checked"),t.user_segment_id=parseInt($("#iInternal .segments-select").val()),!$("#iExternal .gswitch input").prop("checked")){var i="ComponentsAffected:";e.find('.components-affected input[type="checkbox"]:checked').each(function(){i+=$(this).val()+" "}),t.platformIDs=i}ce(a,t,"incident")}$("#iExternal .gswitch input").prop("checked")&&(t.incidentName=e.find("#incident-name").val(),t.message=$("#iExternal textarea").val(),t.notifications=$("#iExEmailSubscribers").prop("checked"),t.sas_visibility=$("#iExShowHomepage").prop("checked"),t.user_segment_id=parseInt($("#iExternal .segments-select").val()),e.find('.components-affected input[type="checkbox"]:checked').each(function(){ce($(this).val(),t,"incident")})),$("#create-incident-modal").fadeOut("fast"),H(),Q(C,0,function(e){$(".btn").removeAttr("disabled"),$e(e)})}}),$("#create-new-incident-btn").on("click",function(){console.log("%c Creating External Incident ","background:#006dcc; color:#ffffff;font-size:15px;"),$(this).attr("disabled","disabled");var e,t=$("#new-incident-modal"),n=t.find(".component-container").find("input:checked"),i=[],a="",s=k.substr(0,k.indexOf("]")+1);i.incidentName=t.find("#incident-name").val(),i.incidentStatus=t.find('.incident-status input[type="radio"]:checked').val(),i.incidentSeverity=t.find(".incident-severity select").val(),t.find('.components-affected input[type="checkbox"]:checked').siblings("span").each(function(){a+="["+$(this).text().trim()+"]"}),(e=s+" "+a+" "+i.incidentName)!=k&&C.push(X(g,e)),""!=i.incidentName&&null!=i.incidentStatus&&n.length?(i.user_segment_id=parseInt($("#iExternal .segments-select").val()),i.message=t.find("#new-external-message").val(),i.notifications=t.find("#iExEmailSubscribers").prop("checked"),i.sas_visibility=$("#iExShowHomepage").prop("checked"),$.each(n,function(e,t){ce(t.value,i,"incident")}),Q(C,0,function(e){updateModal(g),$("#new-incident-modal").hide()})):($(this).removeAttr("disabled"),alert("Please fill up all the fields."))}),$("#create-new-scheduled-maintenance").click(function(){console.log("%c Create Maintenance ","background:#006dcc; color:#ffffff;font-size:15px;"),$(this).attr("disabled",!0);var e=$(this).closest(".modal"),t=[];if(t.maintenanceName=e.find("#maintenance-name").val(),t.startTime=[],t.startTime.date=e.find(".maintenance-start input[type='date']").val(),t.startTime.time=e.find(".maintenance-start .time-select").val(),t.endTime=[],t.endTime.date=e.find(".maintenance-end input[type='date']").val(),t.endTime.time=e.find(".maintenance-end .time-select").val(),""==t.maintenanceName||null==e.find('.components-affected input[type="checkbox"]:checked').val())$(this).removeAttr("disabled"),alert("Please fill up all the fields.");else if($("#mInternal .gswitch input").prop("checked")&&""==$("#mInternal textarea").val()||$("#mExternal .gswitch input").prop("checked")&&""==$("#mExternal textarea").val())$(this).removeAttr("disabled"),alert("Internal or External message is enabled but empty.\nPlease disable it or add the message.");else{if($("#mInternal .gswitch input").prop("checked")){var n="";e.find('.components-affected input[type="checkbox"]:checked').siblings("span").each(function(){n=n+"["+$(this).text().trim()+"]"}),n=n+" "+e.find("#maintenance-name").val(),t.maintenanceName=n,t.maintenanceDetails=$("#mInternal textarea").val(),t.notifications=$("#mEmailSubscribers").prop("checked"),t.user_segment_id=parseInt($("#mInternal .segments-select").val()),ce(messageBoardInternal,t,"maintenance")}function a(e){$("#incident-"+e.section_id+" .incident-list").html(""),$e(e.id),C=[]}$("#mExternal .gswitch input").prop("checked")&&(t.maintenanceName=e.find("#maintenance-name").val(),t.maintenanceDetails=$("#mExternal textarea").val(),t.notifications=$("#mExEmailSubscribers").prop("checked"),t.sas_visibility=$("#mExShowHomepage").prop("checked"),t.user_segment_id=parseInt($("#mExternal .segments-select").val()),e.find('.components-affected input[type="checkbox"]:checked').each(function(){ce($(this).val(),t,"maintenance")})),$(".btn").removeAttr("disabled"),$("#new-scheduled-maintenance-modal").fadeOut("fast"),H(),function t(n,i){console.log("\nRequest: ",n[i]);$.ajax(n[i]).done(function(e){console.log("Status: %c Success ","background:#222; color:#00ff00"),"delete"!==n[i].type.toLowerCase()&&console.log("Response: ",e),i<n.length-1?t(n,i+1):a(e.article)}).fail(function(e){console.log("Status: %c Error ","background:#222; color:#ff0000"),console.log("Response",e)})}(C,0)}}),$(".delete-template-btn").on("click",function(){if(confirm("Delete this template?")){var e=$(this).parent().parent().find("select.update-template-dropdown").val();$.ajax({url:"/api/v2/help_center/articles/"+e+".json",type:"DELETE",success:function(){setTimeout(function(){ae()},2e3)}}),$(".close-modal").click()}}),$(".incident-nav-cont").on("click",".incident-nav-item:not(:last-child)",function(e){var t=$(this).children("span").text();me(t,1),$(".incident-list-cont").hide(),$("#incident-"+t).show(),$(".incident-nav-item").removeClass("incident-nav-item-active"),$(this).addClass("incident-nav-item-active")}),$("#goto-incidents").on("click",function(){$("main.messageBoard").children("div").not(".container-divider").hide(),$(".incident-container").show(),$(".incident-nav-item").first().click(),$(".message-board-container nav.user-nav a").removeClass("active"),$(this).addClass("active")}),$("#goto-platforms").on("click",function(){""==$(".platform-list-cont").text()&&ue(m.getItem("category"));$("main.messageBoard").children("div").not(".container-divider").hide(),$(".platform-container").show(),$(".message-board-container nav.user-nav a").removeClass("active"),$(this).addClass("active")}),$("#goto-subscribers").on("click",function(){$("main.messageBoard").children("div").not(".container-divider").hide(),$(".subs-container").show(),$(".message-board-container nav.user-nav a").removeClass("active"),$(this).addClass("active")}),$("#goto-status, .message-board-container .logo").on("click",function(e){e.preventDefault(),de()}),$(document).keydown(function(e){27==e.keyCode&&de()}),$("#goto-messageBoard-admin").on("click",function(){$("#back-incident-list").click(),$(".message-board-container").css("left","20%"),$("html").css("overflow","hidden"),$("#goto-incidents").click(),$("body").append('<div class="modal-backdrop fade in" style="background:rgba(0,0,0,0.4);z-index:1"></div>'),$(".wrapper").css("filter","blur(2px)")}),$("#hide_incidents").on("click",function(){$(".incident-container").hide(),$(".container").show()}),$("#create-platform-btn").on("click",function(e){$("body").append('<div class="modal" id="create-platform-modal"> <div class="modal-content"> <div class="modal-header"><button class="close close-modal">X</button><h1>Create New Platform </h1></div> <div class="modal-body"><div class="modal-body-detail platform-name"><label>Platform Name</label><br><input type="text" placeholder="Platform Name"> <span class="info"> </span> </div> <div class="modal-body-detail platform-display-name"><label>Display Name</label><br><input type="text" placeholder="Display Name"><span class="info"></span></div><div class="modal-body-detail platform-user-segment"><label>User Segment</label><br><select><option value="">Visible to everyone</option><option value="526223">Signed-in users</option><option value="526203">Agents and managers</option></select><span class="info">User segments are groups of users who can view content in your Status Page.</span></div></div><div class="modal-footer"><button class="btn btn-primary" id="create-new-platform">CREATE PLATFORM </button></div></div></div>'),$("#create-platform-modal").fadeIn("fast")}),$(".incident-container").on("click",".incident-item-delete, #incident-item-delete",function(e){var n=$(this),i=n.parent().find(".hide").text(),a="Delete this incident?",s="Related incidents will not be deleted automatically.\nPlease view incident for related incidents.";$.ajax({type:"GET",url:"/api/v2/help_center/articles/"+i+".json",dataType:"json"}).done(function(e){e.article.label_names.toString().includes("RelatedIncidents:")&&(a=s+="\n\n"+a);var t={url:"/api/v2/help_center/articles/"+i+".json",type:"DELETE"};confirm(a)&&(console.log("%c Delete Incident ","background:#ef4a5b; color:#ffffff;font-size:15px;"),console.log("\nRequest: ",t),$.ajax(t).done(function(){console.log("Status: %c Success ","background:#222; color:#00ff00")}).fail(function(e){console.log("Status: %c Error ","background:#222; color:#ff0000"),console.log("Response",e)}),n.closest(".incident-list-item").remove(),r=!0)})}),$(".incident-container").on("click",".incident-item-archive",function(e){var n=$(this).closest("div").find("span.hide").text();"Archive"==$(this).text()?($.ajax({url:"/api/v2/help_center/articles/"+n+"/labels.json",type:"POST",data:{label:{name:"Archived"}}}),$(this).html("Unarchive").removeClass("activate").addClass("activated")):($.get("/api/v2/help_center/articles/"+n+"/labels.json",function(e){for(var t=0;t<e.labels.length;t++)"Archived"==e.labels[t].name&&$.ajax({url:"/api/v2/help_center/articles/"+n+"/labels/"+e.labels[t].id+".json",type:"DELETE"})}),$(this).html("Archive").removeClass("activated").addClass("activate")),r=!0}),$(".incident-container").on("click",".incident-item-hide",function(e){var n=$(this).closest("div").find("span.hide").text();"Hide"==$(this).text()?($.get("/api/v2/help_center/articles/"+n+"/labels.json",function(e){for(var t=0;t<e.labels.length;t++)"ShowInHomepage"==e.labels[t].name&&$.ajax({url:"/api/v2/help_center/articles/"+n+"/labels/"+e.labels[t].id+".json",type:"DELETE"})}),$.ajax({url:"/api/v2/help_center/articles/"+n+"/labels.json",type:"POST",data:{label:{name:"Hidden"}}}),$(this).html("Show").removeClass("activated").addClass("activate")):($.get("/api/v2/help_center/articles/"+n+"/labels.json",function(e){for(var t=0;t<e.labels.length;t++)"Hidden"==e.labels[t].name&&$.ajax({url:"/api/v2/help_center/articles/"+n+"/labels/"+e.labels[t].id+".json",type:"DELETE"})}),$.ajax({url:"/api/v2/help_center/articles/"+n+"/labels.json",type:"POST",data:{label:{name:"ShowInHomepage"}}}),$(this).html("Hide").removeClass("activate").addClass("activated")),r=!0}),$(".incident-view-page").on("click","#delete-incident-btn",function(e){if(confirm("Delete this incident?")){var t=$(this).find("span.hide").text();if($.ajax({url:"/api/v2/help_center/articles/"+t+".json",type:"DELETE"}),$(".messageBoard .incident-view-page").is(":visible")){$(".incident-view-page").html("").hide(),$(".incident-container").show();var n=$(".incident-nav-item-active").children("span").text();setTimeout(function(){$("#incident-"+n+" .incident-list").html(""),me(n,1)},1e3),r=!0}else setTimeout(function(){location.reload()},500)}}),$(".incident-container, .incident-view-page").on("click",".incident-item-view",function(e){$(this).css("cursor","progress"),$(this).attr("disabled","disabled"),$e($(this).parent().find(".hide").text())}),$(".incident-view-page").on("click","#update-incident-btn",function(e){"360002990152"===$(".incident-nav-item.incident-nav-item-active span").text()?$("#updateMessage").css("background-color","#FFFDF6"):"360002990152"===$("a.active span").text()&&$("#updateMessage").css("background-color","#FFFDF6")}),$(".incident-view-page, .incident-container").on("click","#update-incident-btn",function(e){$(this).attr("disabled","disabled");var s=$(this).children(".hide").text(),l=$(this).children("#platform_id").text();updateModal=function(i){function a(t){$("body").append('<div class="modal" id="update-incident-modal"><div class="modal-content"><div class="modal-header"><button class="close close-modal">X</button><h1>Update Incident Status</h1></div> <div class="modal-body"> <div class="modal-body-detail"><label>Incident Status</label> <div class="status-choices"> <input type="radio" id="sc1" name="status-choices" value="Investigating"> <label class="radio-label" for="sc1">Investigating</label> <input type="radio" id="sc2" name="status-choices" value="Identified"><label class="radio-label" for="sc2">Identified </label> <input type="radio" id="sc3" name="status-choices" value="Monitoring"> <label class="radio-label" for="sc3">Monitoring</label> <input type="radio" id="sc4" name="status-choices" value="Resolved"> <label class="radio-label" for="sc4">Resolved </label> </div> </div><div class="modal-body-detail incident-severity"><label>Incident Severity</label><br><select><option value="1">Operational</option><option value="3">Degraded Performance</option><option value="4">Minor Outage</option><option value="5">Major Outage</option></select></div><div id="update-internal-message" class="modal-body-detail" style="padding: 20px;border: 1px solid #ababab;border-radius: 5px; background-color:#fffdf6;"> <label style="margin-bottom: 10px;font-size:18px;">Internal Message </label><label class="gswitch" id="switch-internal"><input type="checkbox" id="internal-message-switch"><span class="gslider round"></span></label><div class="modalOptions" style="clear: both; display: block;margin-bottom:30px">Send alert to subscribers<label class="gswitch"><input type="checkbox" id="send-comment-notif"><span class="gslider round green"></span></label></div><textarea id="update-incident-body-internal" class="message-internal" placeholder="Message"></textarea> </div><div class="components-affected-update"></div><div id="no-internal-incident"class="modal-body-detail" style="padding: 20px;border: 1px solid #ababab;border-radius: 5px; background-color:#F5FDFE;display:none;"> <label style="margin-bottom: 10px;font-size:18px;">No Related Internal Incident</label></div><div id="update-external-message" class="modal-body-detail message-external" style="padding: 20px;border: 1px solid #ababab;border-radius: 5px; background-color:#F5FDFE; margin-top:20px;"> <label style="margin-bottom: 10px;font-size:18px;">External Message </label><a class="new-incident-btn incident-subscribe-button incident-save-button hide"><i class="fas fa-plus"></i> NEW INCIDENT</a><label class="gswitch" id="switch-external"><input type="checkbox" id="external-message-switch"><span class="gslider round"></span></label><div class="modalOptions" style="clear: both; display: block;margin-bottom:30px;">Send alert to subscribers<label class="gswitch"><input type="checkbox" id="send-comment-notif"><span class="gslider round green"></span></label></div><textarea id="update-incident-body-external" placeholder="Message"></textarea> </div></div><div class="modal-footer"><button class="btn btn-primary" id="update-incident-status">UPDATE STATUS<span class="hide">'+s+'</span><span class="current-platform-id" id="'+currentSec+'"></span><span id="incident-title" style="display:none;">'+t+"</span></button></div></div></div>");var n='<div class="segments-container"><label for="segments-select">Visible To</label>'+z()+" </div>";if($(n).insertAfter("#switch-internal"),$(n).insertAfter("#switch-external"),$("#update-internal-message .segments-select").val(internalUserSegmentID),$("#update-external-message .segments-select").val(externaluserSegmentID),$("#update-internal-message .segments-select").on("change",function(){$(this).val()!=internalUserSegmentID&&(O=!0)}),$("#update-external-message .segments-select").on("change",function(){$(this).val()!=internalUserSegmentID&&(P=!0)}),$("#update-external-message .segments-select").val(externaluserSegmentID),$("#update-internal-message .gswitch input, #update-external-message .gswitch input").prop("checked",!0),$("html").css("overflow","hidden"),$("#update-incident-modal").fadeIn("fast"),$("#update-internal-message .gswitch input, #update-external-message .gswitch input").prop("checked")?$("#send-comment-notif").prop("checked",!0):$("#send-comment-notif").prop("checked",!1),$("#update-incident-modal").find("textarea").val(""),"block"==$(".incident-container").css("display")&&$("#related-incident").is(":visible")||$(".modal-content .modal-footer").prepend(htmlElementIncident),$("#relatedIncidentAffected").is(":visible")||$(".components-affected-update").prepend(relatedIncidentCheckbox),(l==messageBoardInternal||hasRelatedInternal)&&($("textarea#update-incident-body-internal").ckeditor(),CKEDITOR.instances["update-incident-body-internal"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body-internal"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body-internal"]).toggleTracking(!1,!1),$("#update-internal-message").fadeIn("fast")},200)})),(l!=messageBoardInternal||hasRelatedIncidents)&&($("textarea#update-incident-body-external").ckeditor(),CKEDITOR.instances["update-incident-body-external"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body-external"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body-external"]).toggleTracking(!1,!1),$("#update-external-message").fadeIn("fast")},200)})),l==messageBoardInternal){if($(".modal-body-detail.global-notifications .gswitch input").prop("checked",!0),$("#updateMessage").css("background-color","#FFFDF6"),$(".modal-body-detail.global-notifications .gswitch input").prop("checked")?$(".subscribe-global-notif").prop("checked",!0):$(".subscribe-global-notif").prop("checked",!1),!hasRelatedIncidents){var e=document.getElementById("external-message-switch");e.checked=!1,e.disabled=!0,setTimeout(function(){re()},200),$("#update-incident-modal").find("#switch-external").hide(),$("#update-incident-modal").find(".new-incident-btn").removeClass("hide"),j=currentArticle}}else if(!hasRelatedInternal){var i=document.getElementById("internal-message-switch");console.log(i),i.checked=!1,i.disabled=!0,setTimeout(function(){oe()},200)}$("#internal-message-switch").on("click",oe),$("#external-message-switch").on("click",re),$("#update-incident-modal").find(".new-incident-btn").on("click",function(){var e=t.substr(t.lastIndexOf("]")+1).trim();$("#update-incident-modal").toggle("slide",function(){$(this).remove()}),newIncidentModal=$("#new-incident-modal").toggle("slide",{direction:"right"}),newIncidentModal.find("#new-external-message").ckeditor(),CKEDITOR.instances["new-external-message"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["new-external-message"].plugins.lite.findPlugin(CKEDITOR.instances["new-external-message"]).toggleTracking(!1,!1),$("#new-external-message").fadeIn("fast")},200)}),newIncidentModal.find(".segments-container").length||$(n).insertAfter(newIncidentModal.find("#showHome")),newIncidentModal.find('.components-affected input[type="checkbox"]').each(function(){affectedComponents.includes($(this).val())&&($(this)[0].checked=!0)}),newIncidentModal.find("#incident-name").val(e)})}htmlElementIncident="",relatedIncidentCheckbox="",relatedIncidentList=[],hasRelatedIncidents=!0,externaluserSegmentID=0,internalUserSegmentID=0,currInternalIncident={},affectedComponents="",hasRelatedInternal=!1,currentArticle={},$.get("/api/v2/help_center/en-us/articles/"+i).done(function(e){currentSec=e.article.section_id,currentArticle=e.article,label=e.article.label_names,labelLength=label.length,W=e.article.title,l=e.article.section_id,e.article.section_id===messageBoardInternal?(g=i,k=W,internalUserSegmentID=e.article.user_segment_id,currInternalIncident=e.article):externaluserSegmentID=e.article.user_segment_id;for(var t=0;t<labelLength;t++){if(label[t].includes("RelatedIncidents:"))var n=label[t].replace(/RelatedIncidents:/g,"").split(" ");label[t].includes("ComponentsAffected:")&&(affectedComponents=label[t])}if(n){n=n.filter(function(e){return""!==e}),htmlElementIncident+='<div id="related-incidents-container"><label id="related-incidents-label">Related Incidents:</label>',relatedIncidentCheckbox+='<div id="relatedIncidentAffected"><label>Related Incidents Affected</label><div class="component-container">',function t(n,i,a){$.get("/api/v2/help_center/articles/"+n[i]).done(function(e){relatedIncidentList.push(e.article),i<n.length-1?t(n,i+1,a):s()}).fail(function(){i<n.length-1?t(n,i+1,a):s()})}(n,0,a)}else hasRelatedIncidents=!1,a(W);function s(){relatedIncidentList.forEach(function(e){var t=e.section_id,n=e.id,i="";t===messageBoardMDX?i="MDX 2.0":t===messageBoardSAS?i="Sizmek Advertising Suite":t===messageBoardDSP?i="DSP":t===messageBoardDMP?i="DMP":t===messageBoardSiteOP?i="Site Optimization":t===messageBoardInternal&&(i="Internal"),htmlElementIncident+='<div class="incident-item-action" id="related-incident"><a class="incident-item-view" href="/hc/en-us/articles/'+n+'" id="related-incident-span">'+i+"</a><span>"+n+"</span></div>","Internal"==i?(g=n,k=e.title,internalUserSegmentID=e.user_segment_id,hasRelatedInternal=!0):(externaluserSegmentID=e.user_segment_id,relatedIncidentCheckbox+='<div class="component"><input type="checkbox" value="'+n+'" checked><span>'+i+'</span><span class="platform-id" id="'+t+'"></span><span id="incident-title" style="display:none;">'+e.title+"</span></div>"),1===relatedIncidentList.length&&"Internal"==i&&(relatedIncidentCheckbox="")}),1<relatedIncidentList.length&&(relatedIncidentCheckbox+="</div>"),htmlElementIncident+="</div>",a(W)}})},updateModal(s)}),$(".incident-view-page").on("click","#update-incident-btn",function(e){"360002990152"===$(".incident-nav-item.incident-nav-item-active span").text()?$("#updateMessage").css("background-color","#FFFDF6"):"360002990152"===$("a.active span").text()&&$("#updateMessage").css("background-color","#FFFDF6")}),$(".incident-view-page, .incident-container").on("click","#update-maintenance-btn",function(e){var n=$(this).children(".hide").text(),t=$(this).children("#platform_id").text(),i=$(".incident-view-page .incident-list-item:last-child .incident-item-cont > span strong:first").text(),a=$(".incident-view-page .incident-list-item:last-child .incident-item-cont > span strong:nth-child(3)").text(),s=(i=i.replace("Maintenance Start: ","").split(" ",2),a=a.replace("Maintenance End: ","").split(" ",2),t==messageBoardInternal?"background-color: #fffdf6;":"background-color: #F5FDFE;"),l='<div class="segments-container"><label for="segments-select">Visible To</label>'+z()+" </div>";$("html").css("overflow","hidden"),$.get("/api/v2/help_center/articles/"+n).done(function(e){var t=e.article.user_segment_id;$("body").append('<div class="modal" id="update-incident-modal"> <div class="modal-content"> <div class="modal-header"><button class="close close-modal">X</button><h1>Update Maintenance Status </h1></div> <div class="modal-body"> <div class="modal-body-detail"> <label>Maintenance Status </label> <div class="status-choices"> <input type="radio" id="mc1" name="status-choices" value="New"> <label class="radio-label" for="mc1">New </label> <input type="radio" id="mc2" name="status-choices" value="Updated"> <label class="radio-label" for="mc2">Updated </label> <input type="radio" id="mc3" name="status-choices" value="Completed"> <label class="radio-label" for="mc3">Completed </label> </div> </div> <div class="modal-body-detail maintenance-message" style="'+s+'"> <label class="modal-body-header">Message </label>'+l+'<div class="modalOptions" style="clear: both; display: block;margin-bottom:30px;">Send alert to subscribers<label class="gswitch"><input type="checkbox" id="send-comment-notif" checked><span class="gslider round green"></span></label></div><textarea id="update-incident-body" placeholder="Message"> </textarea> </div> <div> <input type="checkbox" id="send-time"> <label for="send-time" style="font-weight: 400;font-size: 15px;">Update time. </label> </div> <div class="maintenance-start"> <label>Maintenance Start Time </label> <div class="maintenance-time"> <input disabled type="date" value="'+i[0]+'"> <select disabled class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div> <div class="maintenance-end"> <label>Maintenance End Time </label> <div class="maintenance-time"> <input disabled value="'+a[0]+'" type="date"> <select disabled class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span></div></div><div class="modal-footer"><button class="btn btn-primary" id="update-maintenance-status">UPDATE STATUS <span class="hide">'+n+" </span> </button></div></div></div>"),se(),$("textarea#update-incident-body").ckeditor(),$("#update-incident-modal .segments-select").val(t),CKEDITOR.instances["update-incident-body"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body"]).toggleTracking(!1,!1),$("#update-incident-modal").find("textarea").val(""),$("#update-incident-modal").fadeIn("fast")},300)}),$("#update-incident-modal .maintenance-start .time-select").val(i[1]),$("#update-incident-modal .maintenance-end .time-select").val(a[1]),$("#update-incident-modal .segments-select").on("change",function(){t!=$(this).val()&&(A=!0)})})}),$("body").on("change","#send-time",function(){$(this).is(":checked")?($("#update-incident-modal .maintenance-start input, #update-incident-modal .maintenance-start select").removeAttr("disabled"),$("#update-incident-modal .maintenance-end input, #update-incident-modal .maintenance-end select").removeAttr("disabled")):($("#update-incident-modal .maintenance-start input, #update-incident-modal .maintenance-start select").attr("disabled","disabled"),$("#update-incident-modal .maintenance-end input, #update-incident-modal .maintenance-end select").attr("disabled","disabled"))}),$("body").on("click","#create-new-platform",function(e){$(this).attr("disabled","disabled");var t=m.getItem("category"),n=$(".platform-name input").val(),i=$(".platform-display-name input").val(),a=$(".platform-user-segment select").val();if(""==a&&(a=null),""==n||""==i)return alert("Please fill up all the fields."),$(this).removeAttr("disabled"),!1;$.ajax({url:"/api/v2/help_center/categories/"+t+"/sections.json",type:"POST",data:{section:{locale:"en-us",name:n,description:i+" @component @status:1",user_segment_id:a}},success:function(){$("#create-platform-modal").remove(),ue(t),$(this).removeAttr("disabled")}})}),$("body").on("click","#update-maintenance-status",function(){console.log("%c Update Maintenance ","background:#006dcc; color:#ffffff;font-size:15px;"),$(this).attr("disabled","disabled");var n=$(this).children(".hide").text(),e=$("#platform_id").text(),i=$("#update-incident-body").val(),a=$("#send-comment-notif").is(":checked"),s=$(".status-choices input[name=status-choices]:checked").val(),t=$("#update-incident-modal .segments-select").val(),l=[];if(t=parseInt(t),l.push(U(e)),A&&(l.push(K(n,t)),A=!1),$("#update-incident-modal").hide(),$("#send-time").prop("checked")){var c={},d={},o=$("#update-incident-modal");c.date=o.find(".maintenance-start input[type='date']").val(),c.time=o.find(".maintenance-start .time-select").val(),d.date=o.find(".maintenance-end input[type='date']").val(),d.time=o.find(".maintenance-end .time-select").val();var r="Maintenance Start: "+c.date+" "+c.time+" ",p="Maintenance End: "+d.date+" "+d.time+" ";i="<strong>"+r+"</strong><br><strong>"+p+"</strong><br><br>"+i}function m(){$(this).removeAttr("disabled"),$e(n)}H(),console.log("\nRequest: ","/api/v2/help_center/articles/"+n+"/labels.json"),$.get("/api/v2/help_center/articles/"+n+"/labels.json").done(function(e){console.log("Status: %c Success ","background:#222; color:#00ff00"),console.log("Response: ",e);for(var t=0;t<e.labels.length;t++)if(-1<e.labels[t].name.indexOf("Status")){l.push(G(n,e.labels[t].id));break}l.push(q(n,"Status:"+s)),l.push(V(n,s+" - "+i,a)),function t(n,i,a){console.log("\nRequest: ",n[i]),$.ajax(n[i]).done(function(e){console.log("Status: %c Success ","background:#222; color:#00ff00"),"delete"!==n[i].type.toLowerCase()&&console.log("Response: ",e),i<n.length-1?t(n,i+1,a):a()}).fail(function(e){console.log("Status: %c Error ","background:#222; color:#ff0000"),console.log("Response",e)})}(l,0,m)}).fail(function(e){console.log("Status: %c Error ","background:#222; color:#ff0000"),console.log("Response",e)})}),$("body").on("click","#update-incident-status",function(e){console.log("%c Update Incident ","background:#006dcc; color:#ffffff;font-size:15px;");var u=$(this);u.attr("disabled","disabled").addClass("wait"),num_Incidents=0,incidentsUpdated=0;var t=u.children(".current-platform-id").attr("id"),n=$(".modal-body"),v=$(this).find("span.hide").text(),i=$(this).closest(".modal"),a=[],s=k,l=s.substr("]").substr(s.indexOf("]")+1);a.incidentName=l,a.incidentStatus=i.find('.status-choices input[type="radio"]:checked').val();var c=a.platformname=l;function d(i,e,t){var a=$("#update-incident-modal:visible .incident-severity select").val(),s=$(".status-choices input[name=status-choices]:checked").val(),l=$('#update-external-message input[type="checkbox"]#send-comment-notif').is(":checked"),n=$("#update-incident-body-external").val(),c=$("#update-external-message .segments-select").val();t==messageBoardInternal&&(l=$('#update-internal-message input[type="checkbox"]#send-comment-notif').is(":checked"),n=$("#update-incident-body-internal").val(),c=$("#update-internal-message .segments-select").val()),c=parseInt(c);var d=e,o=d.substr(d.indexOf("] ")+1),r=s+":<br><br>"+n;if(null==s)return alert("Please select status."),u.removeAttr("disabled"),!1;var p=[];function m(t,n){console.log("\nRequest: ",t[n]),$.ajax(t[n]).done(function(e){console.log("Status: %c Success ","background:#222; color:#00ff00"),"delete"!==t[n].type.toLowerCase()&&console.log("Response: ",e),n<t.length-1?m(t,n+1):function(){incidentsUpdated++,incidentsUpdated===num_Incidents&&(P=!1,$e(v));{if(u.removeAttr("disabled"),$(".messageBoard .incident-view-page").is(":visible"))return;$("html").css("overflow","auto")}}()}).fail(function(e){console.log("Status: %c Error ","background:#222; color:#ff0000"),console.log("Response",e)})}p.push(U(t)),p.push(X(i,"["+s+"] "+o)),t==messageBoardInternal&&O&&(p.push(K(i,c)),O=!1),t!=messageBoardInternal&&P&&p.push(K(i,c)),$("#update-incident-modal").css("display","none"),H(),console.log("\nRequest: ","/api/v2/help_center/articles/"+i+"/labels.json"),$.get("/api/v2/help_center/articles/"+i+"/labels.json").done(function(e){console.log("Status: %c Success ","background:#222; color:#00ff00"),console.log("Response: ",e);for(var t=0;t<e.labels.length;t++){var n=e.labels[t];-1<n.name.indexOf("Status:")&&!n.name.includes(s)&&(p.push(G(i,n.id)),p.push(q(i,"Status:"+s))),-1<n.name.indexOf("Severity:")&&!n.name.includes(a)&&(p.push(G(i,n.id)),p.push(q(i,"Severity:"+a)))}p.push(V(i,r,l)),m(p,0)}).fail(function(e){console.log("Status: %c Fail ","background:#222; color:#ff0000"),console.log("Response",e)})}i.find('.component-container input[type="checkbox"]:checked').siblings("span").each(function(){}),a.incidentName=c,a.message=$("#update-incident-body-external").val(),f.push(parseInt(v)),$("#internal-message-switch").is(":checked")&&(d(g,k,messageBoardInternal),num_Incidents++),$("#external-message-switch").is(":checked")&&(num_Incidents+=$(".modal-body").find('.components-affected-update input[type="checkbox"]:checked').length,n.find('.components-affected-update input[type="checkbox"]:checked').each(function(){var e=$(this).parent().children(".platform-id").attr("id");d($(this).val(),$(this).parent().find("#incident-title").text(),e)}),v!=g&&(d(v,$(this).find("#incident-title").text(),t),num_Incidents++))}),$("#create-incident-template-btn").on("click",function(e){$(this).attr("disabled","disabled");var t=$("#new-incident-template-modal .template-name input").val(),n=$("#new-incident-template-modal .incident-status select").val(),i=$("#new-incident-template-modal .incident-severity select").val(),a=$("#new-incident-template-modal .incident-title input").val(),s=$("#new-incident-template-modal .incident-message textarea").val(),l="";if($("#new-incident-template-modal input.affected-component:checkbox:checked").each(function(){l=$(this).val()+","+l}),""==t||""==a)return alert("Please fill up all the fields."),$(this).removeAttr("disabled"),!1;if(""==l)return alert("Please select atleast one components."),$(this).removeAttr("disabled"),!1;var c=a+"::::"+n+"::::"+i+"::::"+s+"::::"+l;$.ajax({url:"/api/v2/help_center/sections/"+d+"/articles.json",type:"POST",data:{article:{title:"[Template]"+t,body:c,locale:"en-us",label_names:["Type:Template","For:Incident"],comments_disabled:!0},notify_subscribers:!1},success:function(){alert("Incident template saved."),$(".modal").fadeOut("fast"),$("#create-incident-template-btn").removeAttr("disabled"),setTimeout(function(){ae()},2e3)}})}),$("#update-incident-template-btn").on("click",function(e){$(this).attr("disabled","disabled");var t=$(this).parent().parent().find("select.update-template-dropdown").val(),n=$("#new-incident-template-modal .template-name input").val(),i=$("#new-incident-template-modal .incident-status select").val(),a=$("#new-incident-template-modal .incident-severity select").val(),s=$("#new-incident-template-modal .incident-title input").val(),l=$("#new-incident-template-modal .incident-message textarea").val(),c="";if($("#new-incident-template-modal input.affected-component:checkbox:checked").each(function(){c=$(this).val()+","+c}),""==n||""==s)return alert("Please fill up all the fields."),$(this).removeAttr("disabled"),!1;if(""==c)return alert("Please select atleast one components."),$(this).removeAttr("disabled"),!1;var d=s+"::::"+i+"::::"+a+"::::"+l+"::::"+c;$.ajax({url:"/api/v2/help_center/articles/"+t+"/translations/en-us.json",type:"PUT",data:{translation:{title:"[Template]"+n,body:d}},success:function(){$(".modal").fadeOut("fast"),$("#update-incident-template-btn").removeAttr("disabled"),setTimeout(function(){ae()},2e3)}})}),$("#create-maintenance-template-btn").on("click",function(e){$(this).attr("disabled","disabled");var t=$("#new-maintenance-template-modal .template-name input").val(),n=$("#new-maintenance-template-modal .maintenance-title input").val(),i=$("#new-maintenance-template-modal .maintenance-message textarea").val(),a="";if($("#new-maintenance-template-modal input.affected-component:checkbox:checked").each(function(){a=$(this).val()+","+a}),""==t||""==n)return alert("Please fill up all the fields."),$(this).removeAttr("disabled"),!1;if(""==a)return alert("Please select atleast one components."),$(this).removeAttr("disabled"),!1;var s=n+":::: :::: ::::"+i+"::::"+a;$.ajax({url:"/api/v2/help_center/sections/"+d+"/articles.json",type:"POST",data:{article:{title:"[Template]"+t,body:s,locale:"en-us",label_names:["Type:Template","For:Maintenance"],comments_disabled:!0},notify_subscribers:!1},success:function(){alert("Maintenance template saved."),$(".modal").fadeOut("fast"),$("#create-maintenance-template-btn").removeAttr("disabled"),setTimeout(function(){ae()},2e3)}})}),$("#update-maintenance-template-btn").on("click",function(e){$(this).attr("disabled","disabled");var t=$(this).parent().parent().find("select.update-template-dropdown").val(),n=$("#new-maintenance-template-modal .template-name input").val(),i=$("#new-maintenance-template-modal .maintenance-title input").val(),a=$("#new-maintenance-template-modal .maintenance-message textarea").val(),s="";if($("#new-maintenance-template-modal input.affected-component:checkbox:checked").each(function(){s=$(this).val()+","+s}),""==n||""==i)return alert("Please fill up all the fields."),$(this).removeAttr("disabled"),!1;if(""==s)return alert("Please select atleast one components."),$(this).removeAttr("disabled"),!1;var l=i+":::: :::: ::::"+a+"::::"+s;$.ajax({url:"/api/v2/help_center/articles/"+t+"/translations/en-us.json",type:"PUT",data:{translation:{title:"[Template]"+n,body:l}},success:function(){$(".modal").fadeOut("fast"),$("#update-maintenance-template-btn").removeAttr("disabled"),setTimeout(function(){ae()},2e3)}})}),$(".platform-list-cont").on("click",".platform-item-open",function(){var e=$(this).closest(".incident-list-item").find(".incident-item-body h5").text();if(confirm($(this).text()+" "+e+" platform?")){var t=$(this).closest("div").children("span").text(),n=$(this).closest("div").find("select").first().val(),i=$(this).closest(".incident-list-item").find(".incident-item-body span").text();if("Hide Content"==$(this).closest(".incident-list-item").find(".platform-open-content").text())var a="@show_content ";else a="";if("Enable"==$(this).text())var s=e+i+a+"@component @status:"+n,l="Disable",c="activated";else s=e+i+a+"@status:"+n,l="Enable",c="activate";$.ajax({url:"/api/v2/help_center/sections/"+t+".json",type:"PUT",data:{section:{description:s}}}),$(this).html(l).prop("title",l+" Platform").removeAttr("class").addClass("platform-item-open").addClass(c),r=!0}}),$(".platform-list-cont").on("click",".platform-open-content",function(){var e=$(this).closest(".incident-list-item").find(".incident-item-body h5").text();if(confirm($(this).text()+" of "+e+"?")){var t=$(this).closest("div").children("span").text(),n=$(this).closest("div").find("select").first().val(),i=$(this).closest(".incident-list-item").find(".incident-item-body span").text();if("Disable"==$(this).closest(".incident-list-item").find(".platform-item-open").text())var a="@component ";else a="";if("Show Content"==$(this).text())var s=e+i+a+"@show_content @status:"+n,l="Hide Content",c="activated";else s=e+i+a+"@status:"+n,l="Show Content",c="activate";$.ajax({url:"/api/v2/help_center/sections/"+t+".json",type:"PUT",data:{section:{description:s}}}),$(this).html(l).prop("title",l).removeAttr("class").addClass("platform-open-content").addClass(c),r=!0}}),$(".platform-list-cont").on("change","select.plat-segment",function(){var e=$(this).closest("div").children("span").text(),t=$(this).val();$.ajax({url:"/api/v2/help_center/sections/"+e+".json",type:"PUT",data:{section:{user_segment_id:t}}}),r=!0}),$(".platform-list-cont").on("change","select.plat-status",function(){var e=$(this).closest(".incident-list-item").find(".incident-item-body h5").text(),t=$(this).closest(".incident-list-item").find(".incident-item-body span").text(),n=$(this).closest("div").children("span").text(),i=$(this).val();if("Hide Content"==$(this).closest(".incident-list-item").find(".platform-open-content").text())var a="@show_content ";else a="";if("Disable"==$(this).closest(".incident-list-item").find(".platform-item-open").text())var s="@component ";else s="";var l=e+t+s+a+"@status:"+i;$.ajax({url:"/api/v2/help_center/sections/"+n+".json",type:"PUT",data:{section:{description:l}}}),$(this).css("background","linear-gradient(to right, #fff 88%,"+E[i-1]),r=!0}),$(".incident-view-page").on("click",".edit_body a",function(){var e=$(this).closest(".incident-list-item").find(".incident-item-cont > span strong:first").text(),t=$(this).closest(".incident-list-item").find(".incident-item-cont > span strong:nth-child(3)").text();if(""!=e&&""!=t)var n=(n=$(this).closest(".incident-list-item").find(".incident-item-cont span.hide").html().replace(e,"").replace(t,"")).substr(n.indexOf("<br><br>")+8),i=(e=e.replace("Maintenance Start: ","").split(" ",2),t=t.replace("Maintenance End: ","").split(" ",2),'<div class="maintenance-start"> <label>Maintenance Start Time </label> <div class="maintenance-time"> <input type="date" value="'+e[0]+'"> <select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div> <div class="maintenance-end"> <label>Maintenance End Time </label> <div class="maintenance-time"> <input value="'+t[0]+'" type="date"> <select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div>');else n=$(this).closest(".incident-list-item").children(".incident-item-cont").children("span.hide").html(),i="";$("body").append('<div class="modal" id="update-incident-message-modal"><div class="modal-content"><div class="modal-header"><button class="close close-modal">X</button><h1>Edit Message</h1></div> <div class="modal-body"><div class="modal-body-detail incident-name"> <label>Title</label> <br><input type="text" id="edit-body-title" name="" value="'+I+'"><span class="info"></span> </div>'+i+'<div class="modal-body-detail"> <label>Message </label> <br> <textarea id="update-incident-body" placeholder="Message">'+n+'</textarea> </div></div><div class="modal-footer"><button class="btn btn-primary" id="update-body-message">UPDATE MESSAGE</button></div></div></div>'),$("textarea#update-incident-body").ckeditor(),CKEDITOR.instances["update-incident-body"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body"]).toggleTracking(!1,!1),$("#update-incident-message-modal").fadeIn("fast")},300)}),se(),$("html").css("overflow","hidden"),$("#update-incident-message-modal .maintenance-start .time-select").val(e[1]),$("#update-incident-message-modal .maintenance-end .time-select").val(t[1])}),$(".incident-view-page").on("click",".edit_update a",function(){var e=$(this).closest(".incident-list-item").find(".incident-item-cont > span strong:first").text(),t=$(this).closest(".incident-list-item").find(".incident-item-cont > span strong:nth-child(3)").text(),n=$(this).children("span.hide").text(),i=$(this).closest(".incident-list-item").children(".incident-item-body").text();if(""!=e&&""!=t)var a=(a=$(this).closest(".incident-list-item").find(".incident-item-cont span.hide").html().replace(e,"").replace(t,"")).substr(a.indexOf("<br><br>")+8),s=(e=e.replace("Maintenance Start: ","").split(" ",2),t=t.replace("Maintenance End: ","").split(" ",2),'<div class="maintenance-start"> <label>Maintenance Start Time </label> <div class="maintenance-time"> <input type="date" value="'+e[0]+'"> <select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div> <div class="maintenance-end"> <label>Maintenance End Time </label> <div class="maintenance-time"> <input value="'+t[0]+'" type="date"><select class="time-select"></select> </div> <span class="info">All times must be specified in EST - Eastern Standard Time(US &amp; Canada) </span> </div>');else a=$(this).closest(".incident-list-item").children(".incident-item-cont").children("span.span-body").html(),s="";$("body").append('<div class="modal" id="update-incident-message-modal"><div class="modal-content"><div class="modal-header"><button class="close close-modal">X</button><h1>Edit Message</h1></div> <div class="modal-body"><div class="modal-body-detail incident-name"> <label>Title</label> <br><input type="text" id="edit-body-title" name="" value="'+I+'"><span class="info"></span> </div>'+s+'<div class="modal-body-detail"> <label>Message </label> <br> <textarea id="update-incident-body" placeholder="Message">'+a+'</textarea> </div></div><div class="modal-footer"><button class="btn btn-primary" id="update-update-message">UPDATE MESSAGE<span class="hide span-update_id">'+n+'</span><span class="hide span-update_status">'+i+"</span></button></div></div></div>"),$("textarea#update-incident-body").ckeditor(),CKEDITOR.instances["update-incident-body"].on("instanceReady",function(e){setTimeout(function(){CKEDITOR.instances["update-incident-body"].plugins.lite.findPlugin(CKEDITOR.instances["update-incident-body"]).toggleTracking(!1,!1),$("#update-incident-message-modal").fadeIn("fast")},300)}),se(),$("html").css("overflow","hidden"),$("#update-incident-message-modal .maintenance-start .time-select").val(e[1]),$("#update-incident-message-modal .maintenance-end .time-select").val(t[1])}),$("body").on("click","#update-incident-message-modal #update-body-message",function(){$(this).attr("disabled","disabled");var e=$(".incident-nav-header").children("span.hide").text(),t=document.getElementById("edit-body-title").value;if($("#update-incident-message-modal .maintenance-start").is(":visible"))var n="<strong>Maintenance Start: "+($('#update-incident-message-modal .maintenance-start input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-start select").val())+"</strong><br><strong>Maintenance End: "+($('#update-incident-message-modal .maintenance-end input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-end select").val())+"</strong><br><br>"+$("#update-incident-message-modal #update-incident-body").val();else n=$("#update-incident-message-modal #update-incident-body").val();$.ajax({url:"/api/v2/help_center/articles/"+e+"/translations/en-us.json",type:"PUT",data:{translation:{title:t,body:n}},success:function(){$("#update-incident-message-modal").remove(),$e(e)}})}),$("body").on("click","#update-incident-message-modal #update-update-message",function(){$(this).attr("disabled","disabled");var e=$(this).children("span.span-update_id").text(),t=$(this).children("span.span-update_status").text(),n=$(".incident-nav-header").children("span.hide").text();if($("#update-incident-message-modal .maintenance-start").is(":visible"))var i="<strong>Maintenance Start: "+($('#update-incident-message-modal .maintenance-start input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-start select").val())+"</strong><br><strong>Maintenance End: "+($('#update-incident-message-modal .maintenance-end input[type="date"]').val()+" "+$("#update-incident-message-modal .maintenance-end select").val())+"</strong><br><br>"+$("#update-incident-message-modal #update-incident-body").val();else i=$("#update-incident-message-modal #update-incident-body").val();$.ajax({url:"/api/v2/help_center/articles/"+n+"/comments/"+e+".json",type:"PUT",data:{comment:{body:t+" - "+i}},success:function(){$("#update-incident-message-modal").remove(),$e(n)}})}),$("body").on("click",".delComment a",function(){var e=confirm("Delete comment?"),t=$(this).children("span.hide").text(),n=$(".incident-nav-header").children("span.hide").text();1==e&&$.ajax({url:"/api/v2/help_center/articles/"+n+"/comments/"+t+".json",type:"DELETE",success:function(){location.reload()}})}),$("body").on("click","#update-incident-modal .close-modal, #create-platform-modal .close-modal, #update-incident-message-modal .close-modal, #add-subscriber-report .close-modal",function(e){if($(".modal-footer #related-incidents-container").remove(),$(this).closest(".modal").remove(),$(".messageBoard .incident-view-page").is(":visible")||$(".messageBoard .platform-container").is(":visible")||$(".messageBoard .subs-container").is(":visible"))return!1;$("html").css("overflow","auto")}),$(".close-modal").click(function(){$(".modal-footer #related-incidents-container").remove(),$(this).closest(".modal").fadeOut("fast")}),$("#new-incident-template").on("click",function(){le(),$("#new-incident-template-modal").fadeIn("fast")}),$("#new-maintenance-template").on("click",function(){le(),$("#new-maintenance-template-modal").fadeIn("fast")}),$(".incident-nav-search").on("keydown",function(){var e=$(".incident-nav-search").val();$(".incident-lists-item:visible").hide(),$('.incident-lists-item div:contains("'+e+'")').show()}),$(".subs-nav-cont").on("click",".subs-nav-item:not(:last-child)",function(e){var o,t=$(this).children("span").text();o=t,$(".subs-list-cont").hide(),$("#subs-"+o).show(),""==$("#subs-"+o+" .subs-lists").html()&&$.get("/api/v2/help_center/en-us/sections/"+o+"/subscriptions.json",function(e){for(var t=e.subscriptions.length,n=(new Date).getMonth(),i=0,a=0;a<t;a++){var s=e.subscriptions[a].user_id,l=e.subscriptions[a].id,c=e.subscriptions[a].created_at,d=new Date(c);he(s,l,d,o),n==d.getMonth()&&i++}$("#subs-"+o+" .subs-list-desc").html("Total "+t+" email subscribers, "+i+" added this month.")}),$(".subs-nav-item").removeClass("subs-nav-item-active"),$(this).addClass("subs-nav-item-active")}),$("#goto-subscribers").on("click",function(){$("main.messageBoard").children("div").not(".container-divider").hide(),$(".subs-container").show(),$(".subs-nav-item").first().click()}),$("#hide_subscribers").on("click",function(){$(".subs-container").hide(),$(".container").show()}),$(".subs-container").on("click",".subs-item-delete",function(e){if(confirm("Remove this subscription?")){var t=$(".subs-nav-item-active span").text(),n=$(this).closest("div").find("span").text();$.ajax({url:"/api/v2/help_center/sections/"+t+"/subscriptions/"+n+".json",type:"DELETE"}),ge(t,n),$(this).closest(".subs-lists-item").remove()}}),$(".subs-container").on("click",".checked-email-subscribers",function(e){confirm("Remove checked subscriptions?")&&ge($(".subs-nav-item-active span").text(),-1)}),$(".subs-container").on("change",".subs-list-header input:checkbox",function(e){this.checked?$(".subs-lists-item:visible input:checkbox").click():$(".subs-lists-item:visible input:checkbox").removeAttr("checked").trigger("change")}),$(".subs-container").on("change",".subs-lists .subs-lists-item:visible input:checkbox",function(e){var t=$(".subs-nav-item-active span").text();if(0<$("#subs-"+t+" .subs-lists-item input:checked").length){if($(".checked-email-subscribers").is(":visible"))return!1;$("#subs-"+t).prepend('<a class="checked-email-subscribers incident-subscribe-button incident-save-button" style="position: absolute;padding: 5px 8px;margin-top:-30px">Remove selected</a>')}else $("#subs-"+t+" .checked-email-subscribers").remove()}),$("#subs-item-add").on("click",function(){var e=$("#subs-add-email").val().replace(/\s/g,"").split(","),a=0;function l(){var i;a<e.length?be(e[a])?(i=e[a],$.get("/api/v2/users/search.json?query="+i,function(e){if(0<e.users.length){var t=e.users[0].id;n=t,s=$(".subs-nav-item-active span").text(),$.ajax({url:"/api/v2/help_center/sections/"+s+"/subscriptions.json",type:"POST",data:{subscription:{source_locale:"en-us",include_comments:!0,user_id:n}},success:function(e){fe(s);var t=e.subscription.user_id,n=e.subscription.id,i=e.subscription.created_at,a=new Date(i);he(t,n,a,s)}}),$('input[type="email"]#subs-add-email').css("width","220px")}else ve(i);var n,s;a++,l()})):(ve(e[a]),a++,l()):$("#subs-add-email").val("")}l()}),$('input[type="email"]#subs-add-email').on("keyup",function(e){var t=$(this).val().replace(/\s/g,"");if(8!=e.keyCode){var n=t.split(","),i=n.length;be(n[i-1])&&$(this).val(t.replace(/\,/g,", ")+","),1<i&&$(this).css("width","60%")}""==t&&$(this).css("width","220px")}),$(".subs-nav-search").on("keydown",function(){var e=$(".subs-nav-search").val();$(".subs-lists-item:visible").hide(),$('.subs-lists-item div:contains("'+e+'")').show()})}else $(".create-incident-modal-btn,.create-maintenance-modal-btn").remove();function $e(y){var x="";if($(".incident-container").is(":visible")||$(".messageBoard .incident-view-page").is(":visible"))var w=".messageBoard ",k="related-incident-view";else w="main:not(.messageBoard) ",k="related-articles-view";$(w+".incident-view-page").html('<div class="loading-animation"><img src="'+gSZMKspingreyGIFURL+'" style="border:0px"></div>'),$.get("/api/v2/help_center/en-us/articles/"+y).done(function(e){var t=e.article;I=t.title;for(var n=e.article.label_names,i=n.length,a=0;a<i;a++)if(n[a].includes("Type:"))var o=n[a].replace("Type:","");else if(n[a].includes("Status:"))x=n[a].replace("Status:","");else if(n[a].includes("Severity:"))var s=n[a].replace("Severity:","");else if(n[a].includes("RelatedIncidents:"))var l=n[a].replace(/RelatedIncidents:/g,"").split(" ");var r=x,p=t.section_id,m=t.title,c=t.created_at,u=new Date(c),v=t.body,d=[];if(void 0!==l)if((l=l.filter(function(e){return""!=e})).length)for(var b='<div id="related-incidents-container" class="'+k+'"><label id="related-incidents-label">Related Incidents:</label>',h=0;h<l.length;h++)!function(t){$.get("/api/v2/help_center/articles/"+l[t]+".json").done(function(e){d.push(e.article),t+1===l.length&&function(){l.length===d.length?f():setTimeout(arguments.callee,100)}()}).fail(function(e){t+1===l.length&&(d.length||(b=""),f())})}(h);else g();else g();function f(){d.forEach(function(e){e.section_id===messageBoardMDX?S="MDX 2.0":e.section_id===messageBoardSAS?S="Sizmek Advertising Suite":e.section_id===messageBoardDSP?S="DSP":e.section_id===messageBoardDMP?S="DMP":e.section_id===messageBoardSiteOP?S="Site Optimization":e.section_id===messageBoardInternal&&(S="Internal"),b+='<div class="incident-item-action" id="related-incident"><a class="incident-item-view" href="/hc/en-us/articles/'+e.id+'">'+S+"</a><span>"+e.id+"</span></div>"}),g()}function g(){if(F(),"Incident"==o)var e="update-incident-btn";else e="update-maintenance-btn";"Incident"==o&&"["===m[0]&&(m=m.slice(m.indexOf("]")+1,m.length));var t=x,n=v;function c(e){var t=e.indexOf(":"),n=e.indexOf("-");return-1<t?-1<n?t<n?":":" -":":":" -"}function d(e){var t=e.indexOf(":"),n=e.indexOf("-");return-1<t?-1<n?t<n?":<br><br>":"- ":":<br><br>":"- "}1<v.indexOf(":<br><br>")&&(t=v.split(":<br><br>",1),n=v.substr(v.indexOf(":<br><br>")+1)),$(w+".incident-view-page").html('<div class="incident-container-show"><div class="incident-navigation"> <div class="incident-nav-header"><div class="incident-header-title" id="incident-title-'+s+'">'+B(x.toUpperCase())+m+'</div><span class="hide">'+y+'</span></div><h3 class="sub-header">Previous Updates</h3></div> <div class="incident-list-cont show"> <div class="incident-list"><div class="incident-list-item"><div class="incident-item-body"><h5>'+t+'</h5></div><div class="incident-item-cont">'+n+'<br><small class="small">Posted on '+u.toDateString()+" "+u.toLocaleTimeString()+'</small><span class="hide">'+v+'<span></div><div class="edit_body"><a>Edit</a></div></div></div><a id="back-incident-list" class="plain-button"><br><span style="font-family:arial">←</span> Incidents</a></div></div>'),s?$(w+".incident-container-show .incident-header-title").css("color",E[s-1]):"Maintenance"==o&&$(w+".incident-container-show .incident-header-title").css("color","rgb(52, 152, 219)"),$(w+".incident-container-show .incident-header-title").css("font-size","28px"),-1<jQuery.inArray("view_support_content",HelpCenter.user.tags)&&null!=o&&setTimeout(function(){null==b&&(b=""),$(w+".incident-view-page .incident-list-cont").append('<a id="delete-incident-btn" class="incident-subscribe-button incident-delete-button">DELETE<span class="hide">'+y+"</span></a><a id="+e+' class="incident-subscribe-button incident-update-button">Update<span class="hide">'+y+'</span><span style="display:none" id="platform_id">'+p+"</span></a>"+b)},200),$.get("/api/v2/help_center/articles/"+y+"/comments.json").done(function(e){for(var t=e.count-1;0<=t;t--){var n=e.comments[t].id,i=e.comments[t].updated_at,a=new Date(i),s=(l=e.comments[t].body).split(c(l),1),l=l.substr(l.indexOf(d(l))+1);$(w+".incident-view-page .incident-list").prepend('<div class="incident-list-item"><div class="incident-item-body"><h5>'+s+'</h5></div><div class="incident-item-cont">'+l+'<br><small class="small">Posted on '+a.toDateString()+" "+a.toLocaleTimeString()+'</small><span class="hide span-body">'+l+'</span></div><div class="edit_update"><a>Edit<span class="hide">'+n+'</span></a></div><div class="delComment"><a>Delete<span class="hide">'+n+"</span></a></div></div>")}$(w+".incident-item-action a, .article-list a").css("cursor","pointer"),$(w+".incident-container, "+w+".section-tree, "+w+".article-list, "+w+".main-components-container, .pagination ul").hide(),$(w+".incident-view-page").fadeIn(),$(window).scrollTop(0),-1!=jQuery.inArray("view_support_content",HelpCenter.user.tags)&&null!=o||$(".edit_update, .edit_body, .delComment").remove(),null==r&&$(".incident-item-body").remove(),$(".incident-item-cont table:not([class*='msgboard'])").addClass("msgboard")})}$("#update-incident-modal").remove()})}function ye(){var s=JSON.parse(m.getItem("platforms"));if("agent"==p||"manager"==p)$.get("/api/v2/users/search.json?query="+HelpCenter.user.email).done(function(e){for(var t=e.users[0].id,a=1,n=1;n<=a;n++)$.get("/api/v2/help_center/users/"+t+"/subscriptions.json?page="+n,function(e){for(var t=0;t<e.subscriptions.length;t++){a=e.page_count;var n=e.subscriptions[t].content_type,i=e.subscriptions[t].content_id.toString();"Section"==n&&-1<jQuery.inArray(i,s)&&($("#component-"+i).append('<span class="subs-id" style="display:none">'+e.subscriptions[t].id+"</span>"),$("#component-"+i+" .article-subscribe").html("Unfollow").addClass("article-unsubscribe").removeClass("article-subscribe"))}$(".component-loader").hide(),$(".main-components-container").css("opacity","1")})}).fail(function(){$(".component-loader").hide()});else if("end_user"==p)for(var e=0;e<s.length;e++)$.get("/api/v2/help_center/en-us/sections/"+s[e]+"/subscriptions.json").done(function(e){0<e.subscriptions.length&&($("#component-"+e.subscriptions[0].content_id).append('<span class="subs-id" style="display:none">'+e.subscriptions[0].id+"</span>"),$("#component-"+e.subscriptions[0].content_id+" .article-subscribe").html("Unfollow").addClass("article-unsubscribe").removeClass("article-subscribe")),$(".component-loader").hide(),$(".main-components-container").css("opacity","1")}).fail(function(){$(".component-loader").hide()})}$(".article-list > li > a").on("contextmenu",function(e){return!1}),$("body").on("click",".article-list > li > a",function(e){e.preventDefault(),$(this).css("cursor","progress");var t=$(this).attr("href").split("/");$e(t[t.length-1].split("-",1))}),$("body").on("click",".treeline a",function(e){e.preventDefault(),$(this).css("cursor","progress");var t=$(this).attr("href").split("/");$e(t[t.length-1].split("-",1))}),$(".incident-view-page").on("click","#back-incident-list",function(){$(".messageBoard .incident-view-page").is(":visible")?($(".incident-view-page").hide().html(""),$(".incident-container").show()):($(".incident-view-page").hide().html(""),"support_kb"==$("#switchTag").val()&&-1==window.location.href.indexOf("/categories/"+u)?$(".section-tree, .article-list#show-data, .main-components-container").show():$(".section-tree, .article-list:not(#show-data), .main-components-container, .pagination ul").show()),me($(this).parent().find("#platform_id").text(),1),$(window).scrollTop(0)}),$("body").on("click",".component .article-subscribe",function(){if("Follow"==$(this).text()){$(this).css("cursor","progress");var e=$(this).parent().find("span.hide").text(),t=$(this);$.ajax({url:"/api/v2/help_center/sections/"+e+"/subscriptions.json",type:"POST",data:{subscription:{source_locale:"en-us",include_comments:!0}},success:function(e){t.parent().append('<span class="subs-id" style="display:none">'+e.subscription.id+"</span>"),t.html("Unfollow").addClass("article-unsubscribe").removeClass("article-subscribe"),t.css("cursor","pointer")}})}}),$("body").on("click",".component .article-unsubscribe",function(){var e=$(this).parent().find("span.hide").text(),t=$(this).parent().find("span.subs-id").text(),n=$(this);$.ajax({url:"/api/v2/help_center/sections/"+e+"/subscriptions/"+t+".json",type:"DELETE"}),n.parent().find("span.subs-id").remove(),n.html("Follow").addClass("article-subscribe").removeClass("article-unsubscribe")})}function xe(){$(".select-picker").each(function(){$(this).prev(".k-select").remove(),$(this).hide().addClass("k-selected").removeClass("select-picker");var n=$(this).val();$(this).before('<div class="k-select" tabindex="-1"><span></span><ul></ul></div>'),$(this).find("option").each(function(){var e=$(this).text(),t=$(this).val();n==t?($(this).parent().prev(".k-select").find("span").first().html(e),$(this).parent().prev(".k-select").find("ul").append('<li style="display:none">'+e+"<span>"+t+"</span></li>")):$(this).parent().prev(".k-select").find("ul").append("<li>"+e+"<span>"+t+"</span></li>")})})}function we(e,t){if(void 0!==history.pushState){var n={Page:e,Url:t};history.pushState(n,n.Page,n.Url)}else window.location.replace("/hc/en-us/articles/360020753431")}setTimeout(function(){"1px"===$("#navbar-container").css("height")?$(".message-board-container, .side-modal").css("top","1px"):$(".message-board-container, .side-modal").css("top","49px"),$("zd-hc-resizer").on("click",function(){$(this).data("clicked",!0);var e=$("#navbar-container").css("height");$("zd-hc-resizer").data("clicked")&&("1px"===e?$(".message-board-container, .side-modal").css("top","49px"):$(".message-board-container, .side-modal").css("top","1px"))})},2e3),setTimeout(function(){$(".article-list a").on("click",function(){var e=$(this).attr("href"),t=window.location.href;t==="/hc/en-us/categories/"+messageBoardCategory?we(e,t.replace("categories/"+messageBoardCategory,"articles/")+e):t==="/hc/en-us/categories/"+messageBoardCategory&&we(e,t.replace("categories/"+messageBoardCategory,"articles/")+e),$(this).addClass("active")})},1e3),$(".incident-view-page").on("click","#back-incident-list",function(){var e=window.location.href;e.indexOf(messageBoardCategory)||e.indexOf(messageBoardMDX)||e.indexOf(messageBoardSAS)||e.indexOf(messageBoardDSP)||e.indexOf(messageBoardDMP)||e.indexOf(messageBoardInternal)||history.back(),$(".article-list a").removeClass("active")})});